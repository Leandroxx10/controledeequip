<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Sistema de Gerenciamento de Equipamentos - Versão Completa</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet"/>
  
  <style>
    /* ===== ESTILOS GERAIS DO SISTEMA ===== */
    :root {
      --primary: #2c3e50;
      --secondary: #3498db;
      --success: #2ecc71;
      --accent: #e74c3c;
      --light: #ecf0f1;
      --dark: #2c3e50;
      --gray: #7f8c8d;
      --radius: 12px;
      --shadow: 0 6px 18px rgba(0,0,0,0.08);
      
      /* Variáveis para modo escuro */
      --bg-primary: #f5f7fa;
      --bg-secondary: #c3cfe2;
      --card-bg: #fff;
      --text-primary: #2c3e50;
      --text-secondary: #7f8c8d;
      --border-color: #ddd;
    }
    
    .dark-mode {
      --bg-primary: #121212;
      --bg-secondary: #1e1e1e;
      --card-bg: #2d2d2d;
      --text-primary: #ffffff;
      --text-secondary: #b0b0b0;
      --border-color: #444;
      --primary: #1a2530;
      --light: #2d2d2d;
      --dark: #f5f5f5;
      --gray: #a0a0a0;
      --shadow: 0 6px 18px rgba(0,0,0,0.3);
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Montserrat', sans-serif;
    }
    
    body {
      background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
      color: var(--text-primary);
      min-height: 100vh;
      padding: 20px;
      transition: background 0.3s ease, color 0.3s ease;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
    }
    
    /* ===== CABEÇALHO DO SISTEMA ===== */
    header {
      background: linear-gradient(135deg, var(--primary), #1a2530);
      color: #fff;
      padding: 18px;
      border-radius: 12px;
      text-align: center;
      box-shadow: var(--shadow);
      margin-bottom: 18px;
    }
    
    h1 {
      font-size: 1.6rem;
    }
    
    /* ===== CONTROLES SUPERIORES ===== */
    .top-controls {
      display: flex;
      gap: 12px;
      align-items: center;
      flex-wrap: wrap;
      margin-bottom: 12px;
    }
    
    .lang-select, .sort-select {
      padding: 8px 12px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      background: var(--card-bg);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
    }
    
    .theme-toggle {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      color: var(--text-primary);
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    /* ===== PAINEL DE ESTATÍSTICAS ===== */
    .dashboard {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 14px;
      margin-bottom: 18px;
    }
    
    .dashboard-card {
      background: var(--card-bg);
      padding: 14px;
      border-radius: 10px;
      text-align: center;
      box-shadow: var(--shadow);
      color: var(--text-primary);
    }
    
    /* ===== ÁREA DE PESQUISA ===== */
    .search-container {
      background: var(--card-bg);
      padding: 14px;
      border-radius: 10px;
      box-shadow: var(--shadow);
      margin-bottom: 18px;
    }
    
    .search-box {
      display: flex;
      gap: 12px;
      align-items: center;
    }
    
    .search-input {
      flex: 1;
      padding: 10px;
      border-radius: 50px;
      border: 1px solid var(--border-color);
      background: var(--card-bg);
      color: var(--text-primary);
    }
    
    /* ===== BOTÕES PRINCIPAIS ===== */
    .add-button, .search-button, .defects-button, .voice-search-button {
      padding: 10px 14px;
      border-radius: 50px;
      border: none;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .add-button {
      background: var(--success);
      color: #fff;
    }
    
    .search-button {
      background: linear-gradient(135deg, var(--secondary), #2980b9);
      color: #fff;
    }
    
    .defects-button {
      background: linear-gradient(135deg, #8e44ad, #9b59b6);
      color: #fff;
    }
    
    .voice-search-button {
      background: linear-gradient(135deg, #e67e22, #d35400);
      color: #fff;
    }
    
    .voice-search-button.listening {
      background: linear-gradient(135deg, #e74c3c, #c0392b);
      animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    /* ===== FILTROS ===== */
    .filters {
      display: flex;
      gap: 8px;
      margin: 12px 0;
      flex-wrap: wrap;
    }
    
    .filter-button {
      padding: 8px 14px;
      border-radius: 50px;
      border: 1px solid var(--border-color);
      background: var(--card-bg);
      cursor: pointer;
      transition: all 0.3s ease;
      color: var(--text-primary);
    }
    
    .filter-button.active {
      background: var(--secondary);
      color: #fff;
      border-color: var(--secondary);
    }
    
    /* ===== GRADE DE EQUIPAMENTOS ===== */
    .equipment-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
      gap: 18px;
    }
    
    .equipment-card {
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--shadow);
      overflow: hidden;
      padding: 12px;
      display: flex;
      gap: 12px;
      align-items: flex-start;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .equipment-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 24px rgba(0,0,0,0.15);
    }
    
    .equipment-card.highlighted {
      border: 3px solid #e74c3c;
      box-shadow: 0 0 20px rgba(231, 76, 60, 0.5);
      animation: highlightPulse 2s infinite;
    }
    
    @keyframes highlightPulse {
      0% { border-color: #e74c3c; }
      50% { border-color: #f39c12; }
      100% { border-color: #e74c3c; }
    }
    
    .images-col {
      width: 160px;
      flex-shrink: 0;
    }
    
    .equipment-image {
      width: 140px;
      height: 100px;
      object-fit: cover;
      border-radius: 8px;
      flex-shrink: 0;
      background: var(--light);
      display: block;
      margin-bottom: 6px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }
    
    .equipment-image:hover {
      transform: scale(1.05);
    }
    
    .equipment-info {
      flex: 1;
    }
    
    .equipment-prefix {
      font-weight: 700;
      color: var(--secondary);
      margin-bottom: 6px;
    }
    
    .equipment-sub {
      color: var(--text-secondary);
      font-size: 0.95rem;
      margin-bottom: 6px;
    }
    
    .equipment-details {
      color: var(--text-secondary);
      font-size: 0.9rem;
      margin-bottom: 6px;
    }
    
    .equipment-actions {
      display: flex;
      gap: 8px;
      margin-top: 8px;
    }
    
    .edit-button, .copy-button, .delete-button, .view-button {
      flex: 1;
      color: #fff;
      border: none;
      padding: 8px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .edit-button {
      background: linear-gradient(135deg, var(--secondary), #2980b9);
    }
    
    .copy-button {
      background: linear-gradient(135deg, #16a085, #1abc9c);
    }
    
    .delete-button {
      background: linear-gradient(135deg, var(--accent), #c0392b);
    }
    
    .view-button {
      background: linear-gradient(135deg, #1e3a5f, #2c5282); /* Azul marinho */
      width: 100%;
      margin-top: 8px;
    }
    
    .edit-button:hover, .copy-button:hover, .delete-button:hover, .view-button:hover {
      filter: brightness(1.1);
      transform: translateY(-2px);
    }
    
    /* ===== CONTROLES DE PAGINAÇÃO ===== */
    .pagination-controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin-top: 20px;
      margin-bottom: 20px;
    }
    
    .pagination-button {
      padding: 8px 12px;
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      cursor: pointer;
      color: var(--text-primary);
      transition: all 0.3s ease;
    }
    
    .pagination-button:hover:not(:disabled) {
      background: var(--secondary);
      color: white;
    }
    
    .pagination-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .pagination-info {
      color: var(--text-secondary);
      font-size: 0.9rem;
    }
    
    /* ===== MODAIS ===== */
    .modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.6);
      align-items: center;
      justify-content: center;
      z-index: 2000;
      padding: 20px;
    }
    
    .modal.show {
      display: flex;
    }
    
    .modal-content {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 16px;
      max-width: 980px;
      width: 100%;
      max-height: 90vh;
      overflow: auto;
      box-shadow: 0 12px 36px rgba(0,0,0,.18);
      color: var(--text-primary);
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }
    
    .close-button {
      background: none;
      border: none;
      font-size: 22px;
      cursor: pointer;
      color: var(--text-secondary);
      transition: color 0.3s ease;
    }
    
    .close-button:hover {
      color: var(--accent);
    }
    
    /* ===== FORMULÁRIOS ===== */
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 12px;
    }
    
    .form-group {
      margin-bottom: 6px;
    }
    
    .form-label {
      display: block;
      margin-bottom: 6px;
      font-weight: 600;
      color: var(--text-primary);
      font-size: 0.95rem;
    }
    
    .form-input, .form-select, .form-textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
      background: var(--card-bg);
      color: var(--text-primary);
    }
    
    .form-input:focus, .form-select:focus, .form-textarea:focus {
      border-color: var(--secondary);
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
      outline: none;
    }
    
    .form-textarea {
      min-height: 90px;
      resize: vertical;
    }
    
    .form-actions {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
      margin-top: 8px;
    }
    
    .cancel-button, .save-button {
      padding: 10px 14px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .cancel-button {
      background: #7f8c8d;
      color: #fff;
    }
    
    .save-button {
      background: linear-gradient(135deg, var(--success), #27ae60);
      color: #fff;
    }
    
    .cancel-button:hover, .save-button:hover {
      filter: brightness(1.1);
      transform: translateY(-2px);
    }
    
    /* ===== NOTIFICAÇÕES ===== */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 12px 18px;
      border-radius: 8px;
      color: #fff;
      display: none;
      z-index: 3000;
      box-shadow: var(--shadow);
    }
    
    .notification.show {
      display: block;
      animation: slideIn 0.3s ease;
    }
    
    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    
    .notification.success {
      background: var(--success);
    }
    
    .notification.error {
      background: var(--accent);
    }
    
    .config-note {
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin-bottom: 8px;
    }
    
    /* ===== ABA DE VÍDEOS ===== */
    .tabs {
      display: flex;
      gap: 12px;
      margin-bottom: 16px;
    }
    
    .tab-button {
      flex: 1;
      padding: 12px;
      background: var(--light);
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
      color: var(--text-primary);
    }
    
    .tab-button.active {
      background: linear-gradient(135deg, #3498db, #2980b9);
      color: #fff;
      transform: translateY(-2px);
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
      animation: fadeIn 0.5s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .video-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
      gap: 20px;
    }
    
    .video-card {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 14px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.08);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .video-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 24px rgba(0,0,0,0.15);
    }
    
    .video-card h3 {
      margin-bottom: 8px;
      font-size: 1.2rem;
      color: #3498db;
    }
    
    .video-card iframe {
      width: 100%;
      height: 220px;
      border: none;
      border-radius: 12px;
      margin-bottom: 8px;
    }
    
    .video-card p {
      color: var(--text-secondary);
      font-size: 0.95rem;
    }
    
    .video-search {
      margin-bottom: 16px;
      display: flex;
      gap: 8px;
    }
    
    .video-search input {
      flex: 1;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      background: var(--card-bg);
      color: var(--text-primary);
    }
    
    .video-add {
      margin-top: 20px;
      padding: 16px;
      background: var(--light);
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }
    
    .video-add label {
      font-weight: 600;
      color: var(--text-primary);
      display: block;
      margin-top: 8px;
    }
    
    .video-add input, .video-add textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      margin-top: 4px;
      background: var(--card-bg);
      color: var(--text-primary);
    }
    
    .video-add button {
      margin-top: 12px;
      padding: 10px 14px;
      border: none;
      border-radius: 8px;
      background: linear-gradient(135deg, #2ecc71, #27ae60);
      color: #fff;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .video-add button:hover {
      filter: brightness(1.1);
      transform: translateY(-2px);
    }
    
    /* ===== MINIATURAS DE VÍDEO ===== */
    .video-iframe {
      position: relative;
      width: 100%;
      background: #000;
      border-radius: 12px;
      overflow: hidden;
    }
    
    .video-iframe video {
      width: 100%;
      height: auto;
      max-height: 480px;
      display: block;
      border-radius: 12px;
      background: #000;
    }
    
    /* ===== BOTÕES DE AÇÃO PARA VÍDEOS ===== */
    .video-actions {
      display: flex;
      gap: 8px;
      margin-top: 12px;
    }
    
    .video-actions button {
      background: var(--light);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 6px 12px;
      margin: 2px;
      cursor: pointer;
      font-size: 13px;
      transition: all 0.2s ease-in-out;
      color: var(--text-primary);
    }
    
    .video-actions button:hover {
      background: var(--border-color);
      border-color: var(--text-secondary);
    }
    
    .video-actions .edit-btn {
      color: #1565c0;
    }
    
    .video-actions .delete-btn {
      color: #c62828;
    }
    
    /* ===== MODAL DE VISUALIZAÇÃO DE IMAGEM ===== */
    .image-modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.8);
      align-items: center;
      justify-content: center;
      z-index: 3000;
    }
    
    .image-modal.show {
      display: flex;
    }
    
    .image-modal img {
      max-width: 90%;
      max-height: 90%;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0,0,0,.5);
    }
    
    /* ===== INDICADOR DE BUSCA POR VOZ ===== */
    .voice-indicator {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.8);
      color: white;
      padding: 20px;
      border-radius: 12px;
      z-index: 4000;
      text-align: center;
      box-shadow: 0 0 30px rgba(231, 76, 60, 0.5);
    }
    
    .voice-indicator.show {
      display: block;
      animation: fadeIn 0.3s ease;
    }
    
    .voice-indicator i {
      font-size: 48px;
      margin-bottom: 10px;
      color: #e74c3c;
      animation: pulse 1.5s infinite;
    }
    
    /* ===== ESTILOS PARA A BUSCA INTELIGENTE COM IA ===== */
    .ai-search-container {
      background: var(--card-bg);
      padding: 14px;
      border-radius: 10px;
      box-shadow: var(--shadow);
      margin-bottom: 18px;
      border-left: 4px solid #3498db;
    }
    
    .ai-search-title {
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .ai-search-title i {
      color: #3498db;
    }
    
    .ai-search-description {
      color: var(--text-secondary);
      font-size: 0.9rem;
      margin-bottom: 12px;
    }
    
    .ai-search-examples {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }
    
    .ai-search-example {
      background: var(--light);
      border: 1px solid var(--border-color);
      border-radius: 20px;
      padding: 6px 12px;
      font-size: 0.85rem;
      color: var(--text-primary);
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .ai-search-example:hover {
      background: var(--border-color);
      transform: translateY(-2px);
    }
    
    /* ===== ESTILOS PARA CARTA DE CONTATO ===== */
    .contact-card {
      max-width: 400px;
      margin: 0 auto;
      padding: 20px;
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--shadow);
    }
    
    .contact-photo {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      margin: 0 auto 15px;
      display: block;
      border: 4px solid #3498db;
    }
    
    .contact-info {
      text-align: center;
      margin-bottom: 20px;
    }
    
    .contact-name {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 5px;
    }
    
    .contact-role {
      color: var(--text-secondary);
      font-size: 1rem;
    }
    
    .contact-details {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .contact-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px;
      background: var(--light);
      border-radius: 8px;
    }
    
    .contact-item i {
      width: 20px;
      color: #3498db;
    }
    
    .contact-text {
      flex: 1;
    }
    
    .contact-label {
      font-weight: 600;
      color: var(--text-primary);
      display: block;
      margin-bottom: 2px;
    }
    
    .contact-value {
      color: var(--text-secondary);
      font-size: 0.9rem;
    }
    
    .copy-btn {
      background: #3498db;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 6px 10px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .copy-btn:hover {
      background: #2980b9;
      transform: translateY(-2px);
    }
    
    .contact-note {
      margin-top: 20px;
      padding: 15px;
      background: #e8f4fd;
      border-radius: 8px;
      border-left: 4px solid #3498db;
      font-size: 0.9rem;
      color: var(--text-primary);
    }
    
    /* ===== ESTILOS PARA LOADING ===== */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* ===== ESTILOS PARA PREVIEW DE IMAGENS ===== */
    .image-preview {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }
    
    .image-preview img {
      width: 100px;
      height: 80px;
      object-fit: cover;
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }
    
    /* ===== MELHORIAS PARA DISPOSITIVOS MÓVEIS ===== */
    @media (max-width: 920px) {
      .form-row {
        grid-template-columns: 1fr;
      }
      
      .dashboard {
        grid-template-columns: 1fr;
      }
      
      .equipment-grid {
        grid-template-columns: 1fr;
      }
      
      .search-box {
        flex-wrap: wrap;
      }
      
      .voice-search-button, .search-button {
        flex: 1;
      }
      
      /* MELHORIAS ESPECÍFICAS PARA CARDS EM CELULAR */
      .equipment-card {
        flex-direction: column;
        padding: 15px;
      }
      
      .images-col {
        width: 100%;
        display: flex;
        justify-content: space-around;
        margin-bottom: 10px;
      }
      
      .equipment-image {
        width: 48%;
        height: 120px;
      }
      
      .equipment-info {
        width: 100%;
      }
      
      /* Ajuste para o modal de detalhes do equipamento em mobile */
      .modal-content {
        margin: 10px;
        padding: 15px;
        max-height: calc(100vh - 20px);
        overflow-y: auto;
      }
      
      /* Ajuste para a grade de detalhes do equipamento em mobile */
      #equipmentDetailContent .detail-grid {
        grid-template-columns: 1fr;
      }
    }
    
    /* ===== ESTILOS ESPECÍFICOS PARA DETALHES DO EQUIPAMENTO ===== */
    .detail-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .detail-group {
      background: var(--light);
      padding: 12px;
      border-radius: 8px;
    }
    
    .detail-label {
      font-weight: 600;
      color: var(--text-primary);
      display: block;
      margin-bottom: 5px;
      font-size: 0.9rem;
    }
    
    .detail-value {
      color: var(--text-secondary);
      font-size: 0.95rem;
    }
    
    .detail-full-width {
      grid-column: 1 / -1;
    }
    
    .detail-section-title {
      grid-column: 1 / -1;
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-top: 15px;
      margin-bottom: 10px;
      padding-bottom: 5px;
      border-bottom: 2px solid #3498db;
    }
    
    /* ===== ESTILOS PARA OS CAMPOS DIMENSIONAIS ===== */
    .dimensional-row {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 8px;
    }
    
    .dimensional-group {
      display: flex;
      flex-direction: column;
    }
    
    .dimensional-label {
      font-size: 0.8rem;
      color: var(--text-secondary);
      margin-bottom: 4px;
      text-align: center;
    }
    
    .dimensional-input {
      text-align: center;
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- CABEÇALHO DO SISTEMA -->
    <header>
      <div style="display:flex;align-items:center;gap:12px;justify-content:center;">
        <div style="width:100px;height:70px;border-radius:6px;overflow:hidden;display:flex;align-items:center;justify-content:center;">
          <img src="https://raw.githubusercontent.com/Leandroxx10/controledeequip/refs/heads/main/file_00000000fbb46230a8c8a01e0f8354e6.png" 
               alt="Logo" 
               style="max-width:100%;max-height:100%;object-fit:contain;">
        </div>
        <h1><i class="fas fa-tools"></i> <span id="appTitle">Gerenciador de Equipamentos Completo</span></h1>
      </div>
      <p style="opacity:.9" class="config-note">Conectado ao Firestore: <strong>sistema de equipamentos</strong>.</p>
    </header>

    <!-- CONTROLES SUPERIORES -->
    <div class="top-controls">
      <div class="config-note" style="margin-right:8px;">Conectado ao Firestore: <strong>sistema de equipamentos</strong></div>
      <div style="flex:1"></div>
      
      <!-- Botão para alternar modo escuro/claro -->
      <button class="theme-toggle" id="themeToggle">
        <i class="fas fa-moon"></i> <span id="themeText">Modo Escuro</span>
      </button>
      
      <!-- Seletor de ordenação -->
      <select id="sortSelect" class="sort-select" aria-label="Ordenar equipamentos">
        <option value="prefix-asc">Prefixo (A-Z)</option>
        <option value="prefix-desc">Prefixo (Z-A)</option>
        <option value="date-newest">Mais Recentes</option>
        <option value="date-oldest">Mais Antigos</option>
      </select>
      
      <select id="langToggle" class="lang-select" aria-label="Selecionar idioma">
        <option value="pt">Português</option>
        <option value="en">English</option>
        <option value="it">Italiano</option>
        <option value="zh">中文</option>
        <option value="ja">日本語</option>
      </select>
    </div>

    <!-- PAINEL DE ESTATÍSTICAS -->
    <div class="dashboard">
      <div class="dashboard-card">
        <div style="font-size:22px;font-weight:700" id="totalEquipment">0</div>
        <div style="color:var(--text-secondary)"><span id="totalEquipmentLabel">Total de Equipamentos</span></div>
      </div>
      <div class="dashboard-card">
        <div style="font-size:22px;font-weight:700" id="totalProduction">0</div>
        <div style="color:var(--text-secondary)"><span id="totalProductionLabel">Em Produção</span></div>
      </div>
      <div class="dashboard-card">
        <div style="font-size:22px;font-weight:700" id="totalOut">0</div>
        <div style="color:var(--text-secondary)"><span id="totalOutLabel">Fora de Produção</span></div>
      </div>
    </div>

    <!-- ABA DE NAVEGAÇÃO -->
    <div class="tabs">
      <button class="tab-button active" id="tabEquip">Equipamentos</button>
      <button class="tab-button" id="tabVideos">Video Aulas</button>
      <button class="tab-button" id="tabContato">Contato</button>
    </div>

    <!-- CONTEÚDO DA ABA DE EQUIPAMENTOS -->
    <div id="tabContentEquip" class="tab-content active">
      <div class="search-container">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">
          <h2 style="margin:0" id="listTitle">Lista de Equipamentos</h2>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <button class="add-button" id="addButton"><i class="fas fa-plus"></i> <span id="addBtnText">Novo Equipamento</span></button>
            <button class="defects-button" id="defectsButton"><i class="fas fa-exclamation-triangle"></i> <span id="defectsBtnText">Defeitos</span></button>
          </div>
        </div>

        <!-- BUSCA INTELIGENTE COM IA -->
        <div class="ai-search-container">
          <div class="ai-search-title">
            <i class="fas fa-robot"></i>
            <span>Busca por Voz - Procure por Prefixos</span>
          </div>
          <div class="ai-search-description">
            Clique no microfone e fale o prefixo do equipamento (ex: "LB-545") para ver suas informações. Diga "fechar informação" para fechar.
          </div>
          <div class="search-box">
            <input id="aiSearchInput" class="search-input" placeholder="Ou digite o prefixo do equipamento..." />
            <button id="aiSearchButton" class="search-button"><i class="fas fa-search"></i> Buscar</button>
            <button id="voiceSearchButton" class="voice-search-button" title="Busca por voz"><i class="fas fa-microphone"></i> Voz</button>
          </div>
        </div>

        <!-- BUSCA TRADICIONAL -->
        <div class="filters" id="filters">
          <button class="filter-button active" data-filter="all"><span id="filterAll">Todos</span></button>
          <button class="filter-button" data-filter="production"><span id="filterProduction">Em Produção</span></button>
          <button class="filter-button" data-filter="out"><span id="filterOut">Fora de Produção</span></button>
        </div>

        <div class="search-box" style="margin-top:8px">
          <input id="searchInput" class="search-input" placeholder="Buscar por prefixo (Molde / Blank)..." />
          <button id="searchButton" class="search-button"><i class="fas fa-search"></i> <span id="searchBtnText">Procurar</span></button>
        </div>
      </div>

      <!-- GRADE DE EQUIPAMENTOS -->
      <div id="equipmentGrid" class="equipment-grid"></div>
      
      <!-- CONTROLES DE PAGINAÇÃO -->
      <div class="pagination-controls" id="paginationControls" style="display: none;">
        <button class="pagination-button" id="prevPage" disabled>
          <i class="fas fa-chevron-left"></i> Anterior
        </button>
        <span class="pagination-info" id="pageInfo">Página 1 de 1</span>
        <button class="pagination-button" id="nextPage" disabled>
          Próxima <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>

    <!-- CONTEÚDO DA ABA DE VÍDEOS -->
    <div id="tabContentVideos" class="tab-content">
      <h2 style="display:flex;justify-content:space-between;align-items:center;">
        <span><i class="fas fa-video"></i> Video Aulas</span>
        <span style="font-size:0.9rem;color:#555;">Total: <span id="totalVideos">0</span></span>
      </h2>
      
      <div class="video-search">
        <input type="text" id="videoSearch" placeholder="Buscar vídeos por título ou descrição...">
      </div>
      
      <div id="videoGrid" class="video-list"></div>

      <div class="video-add">
        <h3>Adicionar Novo Vídeo</h3>
        <label for="videoTitulo">Título</label>
        <input id="videoTitulo" required>
        <label for="videoDescricao">Descrição</label>
        <textarea id="videoDescricao"></textarea>
        <label for="videoUrl">URL do Vídeo (YouTube, Vimeo, ou arquivo MP4 do GitHub)</label>
        <input id="videoUrl" placeholder="https://www.youtube.com/embed/XXXX ou https://raw.githubusercontent.com/.../video.mp4">
        <label for="videoThumbnail">Thumbnail (URL da Imagem - opcional)</label>
        <input id="videoThumbnail" placeholder="https://.../thumb.jpg">
        <button id="addVideoBtn"><i class="fas fa-save"></i> Salvar Vídeo</button>
      </div>
    </div>

    <!-- CONTEÚDO DA ABA DE CONTATO -->
    <div id="tabContentContato" class="tab-content">
      <div class="contact-card">
        <img src="https://avatars.githubusercontent.com/u/SEU_USERNAME_AQUI" alt="Foto de Leandro" class="contact-photo" id="contactPhoto">
        <div class="contact-info">
          <div class="contact-name">Leandro</div>
          <div class="contact-role">Desenvolvedor & Suporte Técnico</div>
        </div>
        
        <div class="contact-details">
          <div class="contact-item">
            <i class="fas fa-phone"></i>
            <div class="contact-text">
              <span class="contact-label">Telefone</span>
              <span class="contact-value">+55 11 96329-0107</span>
            </div>
            <button class="copy-btn" data-text="+5511963290107">
              <i class="fas fa-copy"></i>
            </button>
          </div>
          
          <div class="contact-item">
            <i class="fas fa-envelope"></i>
            <div class="contact-text">
              <span class="contact-label">E-mail</span>
              <span class="contact-value">Leandrodevxx@gmail.com</span>
            </div>
            <button class="copy-btn" data-text="Leandrodevxx@gmail.com">
              <i class="fas fa-copy"></i>
            </button>
          </div>
        </div>
        
        <div class="contact-note">
          <i class="fas fa-info-circle"></i>
          Entre em contato para suporte técnico, dúvidas ou solicitações de melhorias no sistema.
        </div>
      </div>
    </div>

    <footer style="text-align:center;margin-top:18px;color:var(--text-secondary)">
      Sistema de Gerenciamento de Equipamentos — Versão Completa com IA
    </footer>
  </div>

  <!-- MODAL PARA ADICIONAR EQUIPAMENTO -->
  <div class="modal" id="addModal" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true">
      <div class="modal-header">
        <h3 id="addModalTitle"><i class="fas fa-plus"></i> <span id="addModalTitleText">Novo Equipamento</span></h3>
        <button class="close-button" data-close="addModal">&times;</button>
      </div>
      <form id="addForm">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="addPrefixoMolde">Prefixo Molde</label>
            <input id="addPrefixoMolde" class="form-input" required />
          </div>
          <div class="form-group">
            <label class="form-label" for="addMoldeAlmox">Molde Almoxarifado</label>
            <select id="addMoldeAlmox" class="form-select">
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
              <option value="13">13</option>
              <option value="14">14</option>
              <option value="15">15</option>
              <option value="16">16</option>
              <option value="17">17</option>
              <option value="18">18</option>
              <option value="19">19</option>
              <option value="20">20</option>
              <option value="20+">20+</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="addPrefixoBlank">Prefixo Blank</label>
            <input id="addPrefixoBlank" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="addBlankAlmox">Blank Almoxarifado</label>
            <select id="addBlankAlmox" class="form-select">
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
              <option value="13">13</option>
              <option value="14">14</option>
              <option value="15">15</option>
              <option value="16">16</option>
              <option value="17">17</option>
              <option value="18">18</option>
              <option value="19">19</option>
              <option value="20">20</option>
              <option value="20+">20+</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="addProcesso">Processo</label>
            <select id="addProcesso" class="form-select" required>
              <option value="SG">SG</option><option value="DG">DG</option><option value="TG">TG</option><option value="QG">QG</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label" for="addClasse">Classe</label>
            <select id="addClasse" class="form-select">
              <option>Classe A</option><option>Classe B</option><option>Classe C</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="addNeckrings">Neckrings</label>
            <input id="addNeckrings" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="addAneisGuias">Aneis Guias</label>
            <input id="addAneisGuias" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="addThimble">Thimbles</label>
            <input id="addThimble" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="addMachos">Machos</label>
            <input id="addMachos" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="addCoolers">Coolers</label>
            <input id="addCoolers" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="addBaffles">Baffles</label>
            <input id="addBaffles" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="addBafflesPlugs">Baffles Plugs</label>
            <input id="addBafflesPlugs" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="addFunis">Funis</label>
            <input id="addFunis" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="addFundos">Fundos</label>
            <input id="addFundos" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="addFundosPlugs">Fundos Plugs</label>
            <input id="addFundosPlugs" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="addSopradores">Sopradores</label>
            <input id="addSopradores" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="addPincas">Pinças</label>
            <input id="addPincas" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="addCorredor">Corredor</label>
            <select id="addCorredor" class="form-select">
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
              <option value="13">13</option>
              <option value="14">14</option>
              <option value="15">15</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label" for="addPrateleira">Prateleira</label>
            <input id="addPrateleira" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group" style="grid-column:1/-1">
            <label class="form-label" for="addObservacoesTopo">Observações</label>
            <input id="addObservacoesTopo" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="addPolimentoMolde">Tipo de Polimento Molde</label>
            <select id="addPolimentoMolde" class="form-select">
              <option>Na madeira</option><option>Na máquina</option><option>Na politriz</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label" for="addPolimentoBlank">Tipo de Polimento Blank</label>
            <select id="addPolimentoBlank" class="form-select">
              <option>Na madeira</option><option>Na máquina</option><option>Na politriz</option><option>Sem Polimento</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="addObservacaoAjustagem">Observações Ajustagem</label>
            <input id="addObservacaoAjustagem" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="addCausasTroca">Observações / Causas de Troca</label>
            <input id="addCausasTroca" class="form-input" />
          </div>
        </div>

        <!-- CAMPOS DIMENSIONAIS MODIFICADOS -->
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Dimensional do Gargalo (mm)</label>
            <div class="dimensional-row">
              <div class="dimensional-group">
                <span class="dimensional-label">Tolerância -</span>
                <input id="addDiametroGargaloMenos" type="number" class="form-input dimensional-input" />
              </div>
              <div class="dimensional-group">
                <span class="dimensional-label">Ideal</span>
                <input id="addDiametroGargaloIdeal" type="number" class="form-input dimensional-input" />
              </div>
              <div class="dimensional-group">
                <span class="dimensional-label">Tolerância +</span>
                <input id="addDiametroGargaloMais" type="number" class="form-input dimensional-input" />
              </div>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">Dimensional do Corpo (mm)</label>
            <div class="dimensional-row">
              <div class="dimensional-group">
                <span class="dimensional-label">Tolerância -</span>
                <input id="addDiametroCorpoMenos" type="number" class="form-input dimensional-input" />
              </div>
              <div class="dimensional-group">
                <span class="dimensional-label">Ideal</span>
                <input id="addDiametroCorpoIdeal" type="number" class="form-input dimensional-input" />
              </div>
              <div class="dimensional-group">
                <span class="dimensional-label">Tolerância +</span>
                <input id="addDiametroCorpoMais" type="number" class="form-input dimensional-input" />
              </div>
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="addObservacoesAdicionais">Observações Adicionais</label>
            <input id="addObservacoesAdicionais" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="addStatus">Status</label>
            <select id="addStatus" class="form-select">
              <option value="production">Em produção</option>
              <option value="out">Fora de produção</option>
              <option value="sample">Amostra</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="addUrlImg1">URL da imagem 1</label>
            <input id="addUrlImg1" class="form-input" placeholder="https://..." />
          </div>
          <div class="form-group">
            <label class="form-label" for="addUrlImg2">URL da imagem 2</label>
            <input id="addUrlImg2" class="form-input" placeholder="https://..." />
          </div>
        </div>

        <div class="image-preview" id="imagePreview">
          <!-- Preview das imagens será inserido aqui -->
        </div>

        <div class="form-actions">
          <button type="button" class="cancel-button" data-close="addModal"><span id="cancelBtnText">Cancelar</span></button>
          <button type="submit" class="save-button"><span id="saveBtnText">Salvar</span></button>
        </div>
      </form>
    </div>
  </div>

  <!-- MODAL PARA EDITAR EQUIPAMENTO -->
  <div class="modal" id="editModal" aria-hidden="true">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="editModalTitle"><i class="fas fa-edit"></i> <span id="editModalTitleText">Editar Equipamento</span></h3>
        <button class="close-button" data-close="editModal">&times;</button>
      </div>
      <form id="editForm">
        <input type="hidden" id="editId" />
        
        <!-- Os mesmos campos do formulário de adição, mas com IDs edit* -->
        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="editPrefixoMolde">Prefixo Molde</label>
            <input id="editPrefixoMolde" class="form-input" required />
          </div>
          <div class="form-group">
            <label class="form-label" for="editMoldeAlmox">Molde Almoxarifado</label>
            <select id="editMoldeAlmox" class="form-select">
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
              <option value="13">13</option>
              <option value="14">14</option>
              <option value="15">15</option>
              <option value="16">16</option>
              <option value="17">17</option>
              <option value="18">18</option>
              <option value="19">19</option>
              <option value="20">20</option>
              <option value="20+">20+</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="editPrefixoBlank">Prefixo Blank</label>
            <input id="editPrefixoBlank" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="editBlankAlmox">Blank Almoxarifado</label>
            <select id="editBlankAlmox" class="form-select">
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
              <option value="13">13</option>
              <option value="14">14</option>
              <option value="15">15</option>
              <option value="16">16</option>
              <option value="17">17</option>
              <option value="18">18</option>
              <option value="19">19</option>
              <option value="20">20</option>
              <option value="20+">20+</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="editProcesso">Processo</label>
            <select id="editProcesso" class="form-select" required>
              <option value="SG">SG</option><option value="DG">DG</option><option value="TG">TG</option><option value="QG">QG</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label" for="editClasse">Classe</label>
            <select id="editClasse" class="form-select">
              <option>Classe A</option><option>Classe B</option><option>Classe C</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="editNeckrings">Neckrings</label>
            <input id="editNeckrings" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="editAneisGuias">Aneis Guias</label>
            <input id="editAneisGuias" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="editThimble">Thimbles</label>
            <input id="editThimble" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="editMachos">Machos</label>
            <input id="editMachos" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="editCoolers">Coolers</label>
            <input id="editCoolers" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="editBaffles">Baffles</label>
            <input id="editBaffles" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="editBafflesPlugs">Baffles Plugs</label>
            <input id="editBafflesPlugs" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="editFunis">Funis</label>
            <input id="editFunis" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="editFundos">Fundos</label>
            <input id="editFundos" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="editFundosPlugs">Fundos Plugs</label>
            <input id="editFundosPlugs" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="editSopradores">Sopradores</label>
            <input id="editSopradores" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="editPincas">Pinças</label>
            <input id="editPincas" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="editCorredor">Corredor</label>
            <select id="editCorredor" class="form-select">
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
              <option value="13">13</option>
              <option value="14">14</option>
              <option value="15">15</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label" for="editPrateleira">Prateleira</label>
            <input id="editPrateleira" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group" style="grid-column:1/-1">
            <label class="form-label" for="editObservacoesTopo">Observações</label>
            <input id="editObservacoesTopo" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="editPolimentoMolde">Tipo de Polimento Molde</label>
            <select id="editPolimentoMolde" class="form-select">
              <option>Na madeira</option><option>Na máquina</option><option>Na politriz</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label" for="editPolimentoBlank">Tipo de Polimento Blank</label>
            <select id="editPolimentoBlank" class="form-select">
              <option>Na madeira</option><option>Na máquina</option><option>Na politriz</option><option>Sem Polimento</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="editObservacaoAjustagem">Observações Ajustagem</label>
            <input id="editObservacaoAjustagem" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="editCausasTroca">Observações / Causas de Troca</label>
            <input id="editCausasTroca" class="form-input" />
          </div>
        </div>

        <!-- CAMPOS DIMENSIONAIS MODIFICADOS NO EDIT -->
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Dimensional do Gargalo (mm)</label>
            <div class="dimensional-row">
              <div class="dimensional-group">
                <span class="dimensional-label">Tolerância -</span>
                <input id="editDiametroGargaloMenos" type="number" class="form-input dimensional-input" />
              </div>
              <div class="dimensional-group">
                <span class="dimensional-label">Ideal</span>
                <input id="editDiametroGargaloIdeal" type="number" class="form-input dimensional-input" />
              </div>
              <div class="dimensional-group">
                <span class="dimensional-label">Tolerância +</span>
                <input id="editDiametroGargaloMais" type="number" class="form-input dimensional-input" />
              </div>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">Dimensional do Corpo (mm)</label>
            <div class="dimensional-row">
              <div class="dimensional-group">
                <span class="dimensional-label">Tolerância -</span>
                <input id="editDiametroCorpoMenos" type="number" class="form-input dimensional-input" />
              </div>
              <div class="dimensional-group">
                <span class="dimensional-label">Ideal</span>
                <input id="editDiametroCorpoIdeal" type="number" class="form-input dimensional-input" />
              </div>
              <div class="dimensional-group">
                <span class="dimensional-label">Tolerância +</span>
                <input id="editDiametroCorpoMais" type="number" class="form-input dimensional-input" />
              </div>
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="editObservacoesAdicionais">Observações Adicionais</label>
            <input id="editObservacoesAdicionais" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="editStatus">Status</label>
            <select id="editStatus" class="form-select">
              <option value="production">Em produção</option>
              <option value="out">Fora de produção</option>
              <option value="sample">Amostra</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="editUrlImg1">URL da imagem 1</label>
            <input id="editUrlImg1" class="form-input" placeholder="https://..." />
          </div>
          <div class="form-group">
            <label class="form-label" for="editUrlImg2">URL da imagem 2</label>
            <input id="editUrlImg2" class="form-input" placeholder="https://..." />
          </div>
        </div>

        <div class="image-preview" id="editImagePreview">
          <!-- Preview das imagens será inserido aqui -->
        </div>

        <div class="form-actions">
          <button type="button" class="cancel-button" data-close="editModal"><span id="cancelEditBtnText">Cancelar</span></button>
          <button type="submit" class="save-button"><span id="saveEditBtnText">Salvar Alterações</span></button>
        </div>
      </form>
    </div>
  </div>

  <!-- MODAL PARA VISUALIZAÇÃO DETALHADA DO EQUIPAMENTO (Voz) -->
  <div class="modal" id="equipmentDetailModal" aria-hidden="true">
    <div class="modal-content" style="max-width: 900px;">
      <div class="modal-header">
        <h3><i class="fas fa-info-circle"></i> <span id="equipmentDetailTitle">Detalhes do Equipamento</span></h3>
        <button class="close-button" data-close="equipmentDetailModal">&times;</button>
      </div>
      <div id="equipmentDetailContent" style="padding: 20px;">
        <!-- Conteúdo será preenchido dinamicamente -->
      </div>
    </div>
  </div>

  <!-- MODAL PARA VISUALIZAÇÃO DO EQUIPAMENTO (Botão Visualizar) -->
  <div class="modal" id="viewModal" aria-hidden="true">
    <div class="modal-content" style="max-width: 900px;">
      <div class="modal-header">
        <h3><i class="fas fa-eye"></i> Visualizar Equipamento</h3>
        <button class="close-button" data-close="viewModal">&times;</button>
      </div>
      <div id="viewModalContent" style="padding: 20px;">
        <!-- Conteúdo será preenchido dinamicamente -->
      </div>
    </div>
  </div>

  <!-- MODAL PARA DEFEITOS -->
  <div class="modal" id="defectsModal" aria-hidden="true">
    <div class="modal-content">
      <div class="modal-header">
        <h3><i class="fas fa-exclamation-triangle"></i> <span id="defectsModalTitle">Defeitos</span></h3>
        <button class="close-button" data-close="defectsModal">&times;</button>
      </div>
      <div class="form-group">
        <label class="form-label" for="defectSelect">Selecione o defeito</label>
        <select id="defectSelect" class="form-select">
          <option value="">-- Selecione --</option>
          <option value="H-">H-</option>
          <option value="H+">H+</option>
          <option value="C-">C-</option>
          <option value="C+">C+</option>
          <option value="Ombro Negativo">Ombro Negativo</option>
          <option value="Friso">Friso</option>
          <option value="Rebarba na terminação">Rebarba na terminação</option>
          <option value="Marca de Molde">Marca de Molde</option>
          <option value="Equipamento fora de Centro">Equipamento fora de Centro</option>
          <option value="Pressão">Pressão</option>
          <option value="Costura">Costura</option>
        </select>
      </div>
      <div class="form-group" id="defectInfo" style="display:none">
        <label class="form-label"> O que é| O que causa | Solução</label>
        <textarea id="defectText" class="form-textarea" readonly></textarea>
      </div>
    </div>
  </div>

  <!-- MODAL PARA EDITAR VÍDEO -->
  <div class="modal" id="editVideoModal" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true" style="max-width:600px">
      <div class="modal-header">
        <h3><i class="fas fa-edit"></i> Editar Vídeo</h3>
        <button class="close-button" data-close="editVideoModal">&times;</button>
      </div>
      <form id="editVideoForm">
        <input type="hidden" id="editVideoId" />
        <div class="form-group">
          <label class="form-label" for="editVideoTitulo">Título</label>
          <input id="editVideoTitulo" class="form-input" required />
        </div>
        <div class="form-group">
          <label class="form-label" for="editVideoDescricao">Descrição</label>
          <textarea id="editVideoDescricao" class="form-textarea"></textarea>
        </div>
        <div class="form-group">
          <label class="form-label" for="editVideoUrl">URL do Vídeo (YouTube, Vimeo, ou arquivo MP4)</label>
          <input id="editVideoUrl" class="form-input" placeholder="https://www.youtube.com/embed/XXXX ou https://exemplo.com/video.mp4" />
        </div>
        <div class="form-group">
          <label class="form-label" for="editVideoThumbnail">Thumbnail (URL da Imagem - opcional)</label>
          <input id="editVideoThumbnail" class="form-input" placeholder="https://.../thumb.jpg" />
        </div>
        <div class="form-actions">
          <button type="button" class="cancel-button" data-close="editVideoModal">Cancelar</button>
          <button type="submit" class="save-button">Salvar Alterações</button>
        </div>
      </form>
    </div>
  </div>

  <!-- NOTIFICAÇÃO -->
  <div id="notification" class="notification"></div>

  <!-- INDICADOR DE BUSCA POR VOZ -->
  <div id="voiceIndicator" class="voice-indicator">
    <i class="fas fa-microphone"></i>
    <p>Ouvindo... Fale o prefixo do equipamento</p>
  </div>

  <!-- MODAL DE VISUALIZAÇÃO DE IMAGEM -->
  <div id="imageModal" class="image-modal">
    <img id="imageModalImg" src="" alt="Preview">
  </div>

  <!-- SCRIPTS DO FIREBASE -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <!-- SCRIPT PRINCIPAL DO SISTEMA -->
  <script>
    // ===================================================================
    // CONFIGURAÇÃO PRINCIPAL DO SISTEMA
    // ===================================================================
    
    /*
     * CONFIGURAÇÕES DO FIREBASE
     * Estas são as credenciais para conectar com o Firebase Firestore
     */
    const firebaseConfig = {
      apiKey: "AIzaSyCGWcYx0EjUMfp7Up4BJIFlZBamOldsBZM",
      authDomain: "sistema-equipamentos-web.firebaseapp.com",
      projectId: "sistema-equipamentos-web",
      storageBucket: "sistema-equipamentos-web.firebasestorage.app",
      messagingSenderId: "1004971035686",
      appId: "1:1004971035686:web:c2de0aa19167b9a9246ae7"
    };

    // SENHA DE ADMINISTRADOR
    const ADMIN_PASSWORD = 'wmoldes2026';
    
    // VARIÁVEIS GLOBAIS DO SISTEMA
    let useFirestore = false;
    let db = null;
    let unsubEquipmentSnapshot = null;
    let unsubVideoSnapshot = null;
    let equipmentData = [];
    let videoData = [];
    let currentFilter = 'all';
    let currentLang = 'pt';
    let currentHighlightedEquipment = null;
    
    // VARIÁVEIS DE PAGINAÇÃO
    let currentPage = 1;
    const itemsPerPage = 10;
    
    // VARIÁVEIS DE ORDENAÇÃO
    let currentSort = 'prefix-asc';
    
    // VARIÁVEIS DE TEMA
    let darkMode = false;

    // ===================================================================
    // ELEMENTOS DA INTERFACE
    // ===================================================================
    const equipmentGrid = document.getElementById('equipmentGrid');
    const addButton = document.getElementById('addButton');
    const addModal = document.getElementById('addModal');
    const editModal = document.getElementById('editModal');
    const viewModal = document.getElementById('viewModal');
    const addForm = document.getElementById('addForm');
    const editForm = document.getElementById('editForm');
    const searchInput = document.getElementById('searchInput');
    const searchButton = document.getElementById('searchButton');
    const filters = document.querySelectorAll('.filter-button');
    const notificationEl = document.getElementById('notification');
    const totalEquipment = document.getElementById('totalEquipment');
    const totalProduction = document.getElementById('totalProduction');
    const totalOut = document.getElementById('totalOut');
    const langToggle = document.getElementById('langToggle');
    const defectsButton = document.getElementById('defectsButton');
    const defectsModal = document.getElementById('defectsModal');
    const defectSelect = document.getElementById('defectSelect');
    const defectInfo = document.getElementById('defectInfo');
    const defectText = document.getElementById('defectText');
    const voiceSearchButton = document.getElementById('voiceSearchButton');
    const voiceIndicator = document.getElementById('voiceIndicator');
    const aiSearchInput = document.getElementById('aiSearchInput');
    const aiSearchButton = document.getElementById('aiSearchButton');
    const equipmentDetailModal = document.getElementById('equipmentDetailModal');
    const equipmentDetailContent = document.getElementById('equipmentDetailContent');
    const viewModalContent = document.getElementById('viewModalContent');
    const contactPhoto = document.getElementById('contactPhoto');
    const videoGrid = document.getElementById('videoGrid');
    const videoSearch = document.getElementById('videoSearch');
    const addVideoBtn = document.getElementById('addVideoBtn');
    const editVideoModal = document.getElementById('editVideoModal');
    const editVideoForm = document.getElementById('editVideoForm');
    const imagePreview = document.getElementById('imagePreview');
    const editImagePreview = document.getElementById('editImagePreview');
    
    // NOVOS ELEMENTOS
    const themeToggle = document.getElementById('themeToggle');
    const sortSelect = document.getElementById('sortSelect');
    const paginationControls = document.getElementById('paginationControls');
    const prevPage = document.getElementById('prevPage');
    const nextPage = document.getElementById('nextPage');
    const pageInfo = document.getElementById('pageInfo');

    // ===================================================================
    // FUNÇÕES DE UTILIDADE
    // ===================================================================

    function showNotification(msg, type = 'success') {
      notificationEl.textContent = msg;
      notificationEl.className = 'notification show ' + (type === 'success' ? 'success' : 'error');
      setTimeout(() => {
        notificationEl.className = 'notification';
      }, 3000);
    }

    function openModal(modal) {
      modal.classList.add('show');
      modal.setAttribute('aria-hidden', 'false');
    }

    function closeModal(modal) {
      modal.classList.remove('show');
      modal.setAttribute('aria-hidden', 'true');
    }

    // Configura os botões de fechar modal
    document.querySelectorAll('[data-close]').forEach(btn => {
      btn.addEventListener('click', (e) => {
        const id = btn.getAttribute('data-close');
        const m = document.getElementById(id);
        if (m) closeModal(m);
      });
    });

    // Configura o fechamento de modal ao clicar fora dele
    document.querySelectorAll('.modal').forEach(mod => {
      mod.addEventListener('click', (e) => {
        if (e.target === mod) closeModal(mod);
      });
    });

    // ===================================================================
    // SISTEMA DE TEMA (MODO ESCURO/CLARO)
    // ===================================================================
    
    function toggleTheme() {
      darkMode = !darkMode;
      if (darkMode) {
        document.body.classList.add('dark-mode');
        themeToggle.innerHTML = '<i class="fas fa-sun"></i> <span id="themeText">Modo Claro</span>';
      } else {
        document.body.classList.remove('dark-mode');
        themeToggle.innerHTML = '<i class="fas fa-moon"></i> <span id="themeText">Modo Escuro</span>';
      }
      
      // Salva a preferência no localStorage
      localStorage.setItem('darkMode', darkMode);
    }
    
    function initTheme() {
      // Verifica se há uma preferência salva no localStorage
      const savedDarkMode = localStorage.getItem('darkMode');
      if (savedDarkMode !== null) {
        darkMode = savedDarkMode === 'true';
      } else {
        // Verifica a preferência do sistema
        darkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      }
      
      // Aplica o tema
      if (darkMode) {
        document.body.classList.add('dark-mode');
        themeToggle.innerHTML = '<i class="fas fa-sun"></i> <span id="themeText">Modo Claro</span>';
      } else {
        document.body.classList.remove('dark-mode');
        themeToggle.innerHTML = '<i class="fas fa-moon"></i> <span id="themeText">Modo Escuro</span>';
      }
    }
    
    // Configura o botão de alternar tema
    themeToggle.addEventListener('click', toggleTheme);

    // ===================================================================
    // SISTEMA DE TRADUÇÃO
    // ===================================================================

    const translations = {
      pt: {
        appTitle: 'Gerenciador de Equipamentos Completo',
        connected: 'Conectado ao Firestore: <strong>sistema de equipamentos</strong>.',
        totalEquipmentLabel: 'Total de Equipamentos',
        totalProductionLabel: 'Em Produção',
        totalOutLabel: 'Fora de Produção',
        listTitle: 'Lista de Equipamentos',
        addNew: 'Adicionar Equipamento',
        defects: 'Defeitos',
        filterAll: 'Todos',
        filterProduction: 'Em Produção',
        filterOut: 'Fora de Produção',
        searchPlaceholder: 'Buscar por prefixo (Molde / Blank)...',
        searchButton: 'Procurar',
        addModalTitle: 'Novo Equipamento',
        editModalTitle: 'Editar Equipamento',
        saveButton: 'Salvar',
        cancelButton: 'Cancelar',
        editButton: 'Editar',
        deleteButton: 'Excluir',
        copyButton: 'Copiar',
        viewButton: 'Visualizar',
        notificationCopied: 'Dados copiados!'
      },
      en: {
        appTitle: 'Equipment Manager Complete',
        connected: 'Connected to Firestore: <strong>equipment system</strong>.',
        totalEquipmentLabel: 'Total Equipment',
        totalProductionLabel: 'In Production',
        totalOutLabel: 'Out of Production',
        listTitle: 'Equipment List',
        addNew: 'New Equipment',
        defects: 'Defects',
        filterAll: 'All',
        filterProduction: 'In Production',
        filterOut: 'Out of Production',
        searchPlaceholder: 'Search by prefix (Mold / Blank)...',
        searchButton: 'Search',
        addModalTitle: 'New Equipment',
        editModalTitle: 'Edit Equipment',
        saveButton: 'Save',
        cancelButton: 'Cancel',
        editButton: 'Edit',
        deleteButton: 'Delete',
        copyButton: 'Copy',
        viewButton: 'View',
        notificationCopied: 'Data copied!'
      }
      // Outros idiomas podem ser adicionados aqui
    };

    function applyLanguage(lang) {
      currentLang = lang;
      const t = translations[lang] || translations.pt;
      
      document.getElementById('appTitle').textContent = t.appTitle;
      document.querySelectorAll('.config-note').forEach(el => el.innerHTML = t.connected);
      document.getElementById('totalEquipmentLabel').textContent = t.totalEquipmentLabel;
      document.getElementById('totalProductionLabel').textContent = t.totalProductionLabel;
      document.getElementById('totalOutLabel').textContent = t.totalOutLabel;
      document.getElementById('listTitle').textContent = t.listTitle;
      document.getElementById('addBtnText').textContent = t.addNew;
      document.getElementById('defectsBtnText').textContent = t.defects;
      document.getElementById('filterAll').textContent = t.filterAll;
      document.getElementById('filterProduction').textContent = t.filterProduction;
      document.getElementById('filterOut').textContent = t.filterOut;
      document.getElementById('searchInput').placeholder = t.searchPlaceholder;
      document.getElementById('searchBtnText').textContent = t.searchButton;
      document.getElementById('addModalTitleText').textContent = t.addModalTitle;
      document.getElementById('editModalTitleText').textContent = t.editModalTitle;
      document.getElementById('saveBtnText').textContent = t.saveButton;
      
      if (document.getElementById('cancelBtnText')) {
        document.getElementById('cancelBtnText').textContent = t.cancelButton;
      }
      if (document.getElementById('cancelEditBtnText')) {
        document.getElementById('cancelEditBtnText').textContent = t.cancelButton;
      }
      if (document.getElementById('saveEditBtnText')) {
        document.getElementById('saveEditBtnText').textContent = t.saveButton;
      }
      
      renderEquipment(getCurrentPageData());
      renderVideos(videoData);
    }

    langToggle.addEventListener('change', (e) => {
      applyLanguage(e.target.value);
    });

    // ===================================================================
    // SISTEMA DE COPIA DE CONTATO
    // ===================================================================

    document.addEventListener('click', function(e) {
      if (e.target.classList.contains('copy-btn') || e.target.closest('.copy-btn')) {
        const button = e.target.classList.contains('copy-btn') ? e.target : e.target.closest('.copy-btn');
        const textToCopy = button.getAttribute('data-text');
        
        navigator.clipboard.writeText(textToCopy).then(() => {
          showNotification('Texto copiado para a área de transferência!');
        }).catch(err => {
          console.error('Erro ao copiar: ', err);
          showNotification('Erro ao copiar texto', 'error');
        });
      }
    });

    // ===================================================================
    // SISTEMA DE ORDENAÇÃO
    // ===================================================================
    
    function sortEquipment(data) {
      if (!data || data.length === 0) return data;
      
      // Faz uma cópia do array para não modificar o original
      const sortedData = [...data];
      
      switch(currentSort) {
        case 'prefix-asc':
          // Ordena por prefixo (A-Z), considerando primeiro as duas letras iniciais
          sortedData.sort((a, b) => {
            const prefixA = (a.prefixoMolde || '').toUpperCase();
            const prefixB = (b.prefixoMolde || '').toUpperCase();
            
            // Extrai as duas primeiras letras
            const lettersA = prefixA.substring(0, 2);
            const lettersB = prefixB.substring(0, 2);
            
            // Extrai os números
            const numbersA = parseInt(prefixA.substring(2)) || 0;
            const numbersB = parseInt(prefixB.substring(2)) || 0;
            
            // Primeiro compara as letras
            if (lettersA !== lettersB) {
              return lettersA.localeCompare(lettersB);
            }
            
            // Se as letras são iguais, compara os números
            return numbersA - numbersB;
          });
          break;
          
        case 'prefix-desc':
          // Ordena por prefixo (Z-A), considerando primeiro as duas letras iniciais
          sortedData.sort((a, b) => {
            const prefixA = (a.prefixoMolde || '').toUpperCase();
            const prefixB = (b.prefixoMolde || '').toUpperCase();
            
            // Extrai as duas primeiras letras
            const lettersA = prefixA.substring(0, 2);
            const lettersB = prefixB.substring(0, 2);
            
            // Extrai os números
            const numbersA = parseInt(prefixA.substring(2)) || 0;
            const numbersB = parseInt(prefixB.substring(2)) || 0;
            
            // Primeiro compara as letras
            if (lettersA !== lettersB) {
              return lettersB.localeCompare(lettersA);
            }
            
            // Se as letras são iguais, compara os números
            return numbersB - numbersA;
          });
          break;
          
        case 'date-newest':
          // Ordena por data de criação (mais recentes primeiro)
          sortedData.sort((a, b) => {
            const dateA = new Date(a.criadoEm || 0);
            const dateB = new Date(b.criadoEm || 0);
            return dateB - dateA;
          });
          break;
          
        case 'date-oldest':
          // Ordena por data de criação (mais antigos primeiro)
          sortedData.sort((a, b) => {
            const dateA = new Date(a.criadoEm || 0);
            const dateB = new Date(b.criadoEm || 0);
            return dateA - dateB;
          });
          break;
          
        default:
          // Ordenação padrão (por prefixo ascendente)
          sortedData.sort((a, b) => {
            const prefixA = (a.prefixoMolde || '').toUpperCase();
            const prefixB = (b.prefixoMolde || '').toUpperCase();
            
            const lettersA = prefixA.substring(0, 2);
            const lettersB = prefixB.substring(0, 2);
            
            const numbersA = parseInt(prefixA.substring(2)) || 0;
            const numbersB = parseInt(prefixB.substring(2)) || 0;
            
            if (lettersA !== lettersB) {
              return lettersA.localeCompare(lettersB);
            }
            
            return numbersA - numbersB;
          });
      }
      
      return sortedData;
    }
    
    // Configura o seletor de ordenação
    sortSelect.addEventListener('change', (e) => {
      currentSort = e.target.value;
      currentPage = 1; // Volta para a primeira página ao mudar a ordenação
      renderEquipment(getCurrentPageData());
    });

    // ===================================================================
    // SISTEMA DE PAGINAÇÃO
    // ===================================================================
    
    function getCurrentPageData() {
      // Aplica filtros e ordenação
      let filteredData = applyCurrentFilterArray();
      filteredData = sortEquipment(filteredData);
      
      // Calcula o índice inicial e final para a página atual
      const startIndex = (currentPage - 1) * itemsPerPage;
      const endIndex = startIndex + itemsPerPage;
      
      // Retorna apenas os itens da página atual
      return filteredData.slice(startIndex, endIndex);
    }
    
    function updatePaginationControls() {
      // Aplica filtros e ordenação para obter o total de itens
      let filteredData = applyCurrentFilterArray();
      filteredData = sortEquipment(filteredData);
      
      const totalItems = filteredData.length;
      const totalPages = Math.ceil(totalItems / itemsPerPage);
      
      // Atualiza as informações da página
      pageInfo.textContent = `Página ${currentPage} de ${totalPages}`;
      
      // Atualiza o estado dos botões
      prevPage.disabled = currentPage <= 1;
      nextPage.disabled = currentPage >= totalPages;
      
      // Mostra ou esconde os controles de paginação
      if (totalPages > 1) {
        paginationControls.style.display = 'flex';
      } else {
        paginationControls.style.display = 'none';
      }
    }
    
    // Configura os botões de paginação
    prevPage.addEventListener('click', () => {
      if (currentPage > 1) {
        currentPage--;
        renderEquipment(getCurrentPageData());
      }
    });
    
    nextPage.addEventListener('click', () => {
      let filteredData = applyCurrentFilterArray();
      filteredData = sortEquipment(filteredData);
      const totalPages = Math.ceil(filteredData.length / itemsPerPage);
      
      if (currentPage < totalPages) {
        currentPage++;
        renderEquipment(getCurrentPageData());
      }
    });

    // ===================================================================
    // SISTEMA DE EQUIPAMENTOS
    // ===================================================================

    function renderEquipment(list) {
      equipmentGrid.innerHTML = '';
      
      if (!list || list.length === 0) {
        equipmentGrid.innerHTML = '<div style="grid-column:1/-1;background:var(--card-bg);padding:20px;border-radius:12px;box-shadow:var(--shadow);text-align:center">Nenhum equipamento encontrado.</div>';
        updateDashboard();
        updatePaginationControls();
        return;
      }
      
      const t = translations[currentLang] || translations.pt;
      
      list.forEach(eq => {
        const card = document.createElement('div');
        // Adiciona classe highlighted se for o equipamento atualmente destacado
        card.className = currentHighlightedEquipment === eq.id ? 'equipment-card highlighted' : 'equipment-card';
        
        let imgHtml = '';
        if (eq.urlImg1) imgHtml += `<img class="equipment-image" src="${eq.urlImg1}" alt="Imagem 1">`;
        if (eq.urlImg2) imgHtml += `<img class="equipment-image" src="${eq.urlImg2}" alt="Imagem 2">`;
        if (!imgHtml) imgHtml = `<div class="equipment-image"></div>`;
        
        let statusColor = '#27ae60';
        let statusText = 'Em produção';
        
        if (eq.status === 'sample') {
          statusColor = '#f39c12';
          statusText = 'Amostra';
        } else if (eq.status === 'out') {
          statusColor = '#c0392b';
          statusText = 'Fora';
        }
        
        card.innerHTML = `
          <div class="images-col">
            ${imgHtml}
          </div>
          <div class="equipment-info">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div>
                <div class="equipment-prefix">${eq.prefixoMolde || '-'}</div>
                <div class="equipment-sub">Blank: ${eq.prefixoBlank || '-'}</div>
              </div>
              <div style="text-align:right">
                <div style="font-weight:700">Classe: ${eq.classe || '-'}</div>
                <div style="font-size:0.85rem;color:${statusColor}">
                  ${statusText}
                </div>
              </div>
            </div>
            <div class="equipment-details">- Neckrings: ${eq.neckrings || '-'}</div>
            <div class="equipment-details">- Aneis Guias: ${eq.aneisGuias || '-'}</div>
            <div class="equipment-details">- Almox Molde: ${eq.moldeAlmox || '-'}</div>
            <div class="equipment-details">- Almox Blank: ${eq.blankAlmox || '-'}</div>
            <div class="equipment-actions">
              <button class="edit-button" data-id="${eq.id}"><i class="fas fa-edit"></i> ${t.editButton}</button>
              <button class="copy-button" data-id="${eq.id}"><i class="fas fa-copy"></i> ${t.copyButton}</button>
              <button class="delete-button" data-id="${eq.id}"><i class="fas fa-trash"></i> ${t.deleteButton}</button>
            </div>
            <button class="view-button" data-id="${eq.id}"><i class="fas fa-eye"></i> ${t.viewButton}</button>
          </div>
        `;
        
        equipmentGrid.appendChild(card);
      });

      // Configura os eventos dos botões
      document.querySelectorAll('.edit-button').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const id = btn.getAttribute('data-id');
          openEditModal(id);
        });
      });
      
      document.querySelectorAll('.copy-button').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const id = btn.getAttribute('data-id');
          const eq = equipmentData.find(x => x.id === id);
          if (!eq) return;
          
          const copyText = `
Prefixo Molde: ${eq.prefixoMolde || ''}
Prefixo Blank: ${eq.prefixoBlank || ''}
Processo: ${eq.processo || ''}
Neckrings: ${eq.neckrings || ''}
Aneis Guias: ${eq.aneisGuias || ''}
Thimbles: ${eq.thimble || ''}
Machos: ${eq.machos || ''}
Coolers: ${eq.coolers || ''}
Baffles: ${eq.baffles || ''}
Baffles Plugs: ${eq.bafflesPlugs || ''}
Funis: ${eq.funis || ''}
Fundos: ${eq.fundos || ''}
Fundos Plugs: ${eq.fundosPlugs || ''}
Sopradores: ${eq.sopradores || ''}
Pinças: ${eq.pincas || ''}
Almox Molde: ${eq.moldeAlmox || ''}
Almox Blank: ${eq.blankAlmox || ''}
Corredor: ${eq.corredor || ''}
Prateleira: ${eq.prateleira || ''}
`;
          
          if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(copyText).then(() => {
              showNotification(translations[currentLang].notificationCopied);
            }).catch(err => {
              const ta = document.createElement('textarea');
              ta.value = copyText;
              document.body.appendChild(ta);
              ta.select();
              try {
                document.execCommand('copy');
                showNotification(translations[currentLang].notificationCopied);
              } catch (e) {
                alert('Falha ao copiar');
              }
              ta.remove();
            });
          } else {
            const ta = document.createElement('textarea');
            ta.value = copyText;
            document.body.appendChild(ta);
            ta.select();
            try {
              document.execCommand('copy');
              showNotification(translations[currentLang].notificationCopied);
            } catch (e) {
              alert('Falha ao copiar');
            }
            ta.remove();
          }
        });
      });
      
      document.querySelectorAll('.delete-button').forEach(btn => {
        btn.addEventListener('click', async (e) => {
          const id = btn.getAttribute('data-id');
          
          const senha = prompt('Digite a senha de autorização para excluir:');
          if (String(senha || '').trim() !== String(ADMIN_PASSWORD || '').trim()) {
            alert('Senha incorreta. Exclusão cancelada.');
            return;
          }
          
          if (!confirm('Confirmar exclusão?')) return;
          
          try {
            if (useFirestore && db) {
              await deleteEquipmentFromFirestore(id);
            } else {
              equipmentData = equipmentData.filter(x => x.id !== id);
              persistLocal();
              renderEquipment(getCurrentPageData());
            }
            showNotification('Equipamento excluído com sucesso!');
          } catch (err) {
            console.error(err);
            showNotification('Erro ao excluir. Veja console.', 'error');
          }
        });
      });
      
      // Configura o evento do botão de visualização
      document.querySelectorAll('.view-button').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const id = btn.getAttribute('data-id');
          openViewModal(id);
        });
      });

      // Configura a visualização de imagens
      document.querySelectorAll('.equipment-image').forEach(img => {
        img.addEventListener('click', (e) => {
          const imageModalImg = document.getElementById('imageModalImg');
          imageModalImg.src = e.target.src;
          document.getElementById('imageModal').classList.add('show');
        });
      });

      updateDashboard();
      updatePaginationControls();
    }

    function updateDashboard() {
      totalEquipment.textContent = equipmentData.length;
      totalProduction.textContent = equipmentData.filter(e => e.status === 'production').length;
      totalOut.textContent = equipmentData.filter(e => e.status !== 'production').length;
    }

    function applyCurrentFilterArray() {
      return equipmentData.filter(e => {
        if (currentFilter === 'all') return true;
        return e.status === currentFilter;
      });
    }

    // ===================================================================
    // FUNÇÃO PARA ABRIR MODAL DE VISUALIZAÇÃO
    // ===================================================================

    function openViewModal(id) {
      const equipment = equipmentData.find(e => e.id === id);
      if (!equipment) return;
      
      const statusText = equipment.status === 'production' ? 'Em produção' : 
                        equipment.status === 'sample' ? 'Amostra' : 'Fora de produção';
      
      const statusColor = equipment.status === 'production' ? '#27ae60' : 
                         equipment.status === 'sample' ? '#f39c12' : '#c0392b';
      
      viewModalContent.innerHTML = `
        <div style="display: flex; justify-content: space-between; align-items: center; background: var(--light); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
          <div>
            <h3 style="margin: 0; color: var(--text-primary);">${equipment.prefixoMolde || 'N/A'}</h3>
            <p style="margin: 5px 0 0; color: var(--text-secondary);">Prefixo Molde</p>
          </div>
          <div style="text-align: right;">
            <div style="font-size: 1.2rem; font-weight: 700; color: ${statusColor}">${statusText}</div>
            <p style="margin: 5px 0 0; color: var(--text-secondary);">Status</p>
          </div>
        </div>
        
        <div class="detail-grid">
          <div class="detail-section-title">Informações Básicas</div>
          
          <div class="detail-group">
            <span class="detail-label">Prefixo Blank:</span>
            <span class="detail-value">${equipment.prefixoBlank || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Processo:</span>
            <span class="detail-value">${equipment.processo || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Classe:</span>
            <span class="detail-value">${equipment.classe || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Almox. Molde:</span>
            <span class="detail-value">${equipment.moldeAlmox || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Almox. Blank:</span>
            <span class="detail-value">${equipment.blankAlmox || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Corredor:</span>
            <span class="detail-value">${equipment.corredor || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Prateleira:</span>
            <span class="detail-value">${equipment.prateleira || '-'}</span>
          </div>
          
          <div class="detail-section-title">Componentes</div>
          
          <div class="detail-group">
            <span class="detail-label">Neckrings:</span>
            <span class="detail-value">${equipment.neckrings || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Aneis Guias:</span>
            <span class="detail-value">${equipment.aneisGuias || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Thimbles:</span>
            <span class="detail-value">${equipment.thimble || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Machos:</span>
            <span class="detail-value">${equipment.machos || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Coolers:</span>
            <span class="detail-value">${equipment.coolers || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Baffles:</span>
            <span class="detail-value">${equipment.baffles || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Baffles Plugs:</span>
            <span class="detail-value">${equipment.bafflesPlugs || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Funis:</span>
            <span class="detail-value">${equipment.funis || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Fundos:</span>
            <span class="detail-value">${equipment.fundos || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Fundos Plugs:</span>
            <span class="detail-value">${equipment.fundosPlugs || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Sopradores:</span>
            <span class="detail-value">${equipment.sopradores || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Pinças:</span>
            <span class="detail-value">${equipment.pincas || '-'}</span>
          </div>
          
          <div class="detail-section-title">Informações Técnicas</div>
          
          <div class="detail-group">
            <span class="detail-label">Polimento Molde:</span>
            <span class="detail-value">${equipment.polimentoMolde || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Polimento Blank:</span>
            <span class="detail-value">${equipment.polimentoBlank || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Dimensional Gargalo (mm):</span>
            <span class="detail-value">Menos: ${equipment.diametroGargaloMenos || '-'} | Ideal: ${equipment.diametroGargaloIdeal || '-'} | Mais: ${equipment.diametroGargaloMais || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Dimensional Corpo (mm):</span>
            <span class="detail-value">Menos: ${equipment.diametroCorpoMenos || '-'} | Ideal: ${equipment.diametroCorpoIdeal || '-'} | Mais: ${equipment.diametroCorpoMais || '-'}</span>
          </div>
          
          ${equipment.observacoesTopo ? `
          <div class="detail-group detail-full-width">
            <span class="detail-label">Observações:</span>
            <span class="detail-value">${equipment.observacoesTopo}</span>
          </div>
          ` : ''}
          
          ${equipment.observacaoAjustagem ? `
          <div class="detail-group detail-full-width">
            <span class="detail-label">Observações de Ajustagem:</span>
            <span class="detail-value">${equipment.observacaoAjustagem}</span>
          </div>
          ` : ''}
          
          ${equipment.causasTroca ? `
          <div class="detail-group detail-full-width">
            <span class="detail-label">Causas de Troca:</span>
            <span class="detail-value">${equipment.causasTroca}</span>
          </div>
          ` : ''}
          
          ${equipment.observacoesAdicionais ? `
          <div class="detail-group detail-full-width">
            <span class="detail-label">Observações Adicionais:</span>
            <span class="detail-value">${equipment.observacoesAdicionais}</span>
          </div>
          ` : ''}
        </div>
      `;
      
      openModal(viewModal);
    }

    // ===================================================================
    // SISTEMA DE BUSCA POR VOZ PARA PREFIXOS
    // ===================================================================

    voiceSearchButton.addEventListener('click', startVoiceRecognition);

    function startVoiceRecognition() {
      if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
        alert('Seu navegador não suporta reconhecimento de voz. Tente usar Chrome ou Edge.');
        return;
      }
      
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      const recognition = new SpeechRecognition();
      
      recognition.lang = 'pt-BR';
      recognition.continuous = false;
      recognition.interimResults = false;
      
      voiceIndicator.classList.add('show');
      voiceSearchButton.classList.add('listening');
      
      recognition.start();
      
      recognition.onresult = function(event) {
        const transcript = event.results[0][0].transcript;
        
        // Remove qualquer highlight anterior
        if (currentHighlightedEquipment) {
          const previousCard = document.querySelector(`[data-id="${currentHighlightedEquipment}"]`);
          if (previousCard) {
            previousCard.closest('.equipment-card').classList.remove('highlighted');
          }
          currentHighlightedEquipment = null;
        }
        
        // Verifica se é comando para fechar
        if (transcript.toLowerCase().includes('fechar informação') || 
            transcript.toLowerCase().includes('fechar') ||
            transcript.toLowerCase().includes('sair')) {
          closeModal(equipmentDetailModal);
          showNotification('Informação fechada.');
          voiceIndicator.classList.remove('show');
          voiceSearchButton.classList.remove('listening');
          return;
        }
        
        // Tenta encontrar um prefixo no que foi dito
        const prefixMatch = extractPrefixFromSpeech(transcript);
        
        if (prefixMatch) {
          const prefix = prefixMatch.toUpperCase();
          const equipment = findEquipmentByPrefix(prefix);
          
          if (equipment) {
            // Destaca o equipamento na lista
            currentHighlightedEquipment = equipment.id;
            renderEquipment(getCurrentPageData());
            
            // Mostra informações detalhadas
            showEquipmentDetails(equipment);
            showNotification(`Mostrando informações do equipamento ${prefix}`);
          } else {
            showNotification(`Equipamento com prefixo ${prefix} não encontrado.`, 'error');
          }
        } else {
          showNotification('Não foi possível identificar um prefixo de equipamento. Tente novamente.', 'error');
        }
        
        voiceIndicator.classList.remove('show');
        voiceSearchButton.classList.remove('listening');
      };
      
      recognition.onerror = function(event) {
        console.error('Erro no reconhecimento de voz:', event.error);
        
        voiceIndicator.classList.remove('show');
        voiceSearchButton.classList.remove('listening');
        
        if (event.error === 'not-allowed') {
          alert('Permissão para usar o microfone foi negada. Por favor, permita o acesso ao microfone.');
        } else if (event.error === 'audio-capture') {
          alert('Nenhum microfone foi detectado. Verifique se há um microfone conectado.');
        } else {
          alert('Erro no reconhecimento de voz: ' + event.error);
        }
      };
      
      recognition.onend = function() {
        voiceIndicator.classList.remove('show');
        voiceSearchButton.classList.remove('listening');
      };
    }

    function extractPrefixFromSpeech(transcript) {
      // Remove espaços e converte para maiúsculas
      const cleanTranscript = transcript.replace(/\s+/g, '').toUpperCase();
      
      // Padrões comuns de prefixos (ex: LB-545, ABC123, XYZ-789)
      const prefixPatterns = [
        /[A-Z]{2,3}-?\d{3,5}/, // Padrão: 2-3 letras, opcional hífen, 3-5 números
        /[A-Z]{1,2}\d{2,4}/,   // Padrão: 1-2 letras, 2-4 números
      ];
      
      for (const pattern of prefixPatterns) {
        const match = cleanTranscript.match(pattern);
        if (match) {
          return match[0];
        }
      }
      
      // Se não encontrou com padrões, tenta extrair qualquer sequência que pareça um prefixo
      const words = transcript.toUpperCase().split(/\s+/);
      for (const word of words) {
        if (word.length >= 3 && word.length <= 8 && /[A-Z]/.test(word) && /\d/.test(word)) {
          return word;
        }
      }
      
      return null;
    }

    function findEquipmentByPrefix(prefix) {
      return equipmentData.find(eq => 
        (eq.prefixoMolde && eq.prefixoMolde.toUpperCase() === prefix) ||
        (eq.prefixoBlank && eq.prefixoBlank.toUpperCase() === prefix)
      );
    }

    function showEquipmentDetails(equipment) {
      const statusText = equipment.status === 'production' ? 'Em produção' : 
                        equipment.status === 'sample' ? 'Amostra' : 'Fora de produção';
      
      const statusColor = equipment.status === 'production' ? '#27ae60' : 
                         equipment.status === 'sample' ? '#f39c12' : '#c0392b';
      
      equipmentDetailContent.innerHTML = `
        <div style="display: flex; justify-content: space-between; align-items: center; background: var(--light); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
          <div>
            <h3 style="margin: 0; color: var(--text-primary);">${equipment.prefixoMolde || 'N/A'}</h3>
            <p style="margin: 5px 0 0; color: var(--text-secondary);">Prefixo Molde</p>
          </div>
          <div style="text-align: right;">
            <div style="font-size: 1.2rem; font-weight: 700; color: ${statusColor}">${statusText}</div>
            <p style="margin: 5px 0 0; color: var(--text-secondary);">Status</p>
          </div>
        </div>
        
        <div class="detail-grid">
          <div class="detail-section-title">Informações Básicas</div>
          
          <div class="detail-group">
            <span class="detail-label">Prefixo Blank:</span>
            <span class="detail-value">${equipment.prefixoBlank || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Processo:</span>
            <span class="detail-value">${equipment.processo || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Classe:</span>
            <span class="detail-value">${equipment.classe || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Almox. Molde:</span>
            <span class="detail-value">${equipment.moldeAlmox || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Almox. Blank:</span>
            <span class="detail-value">${equipment.blankAlmox || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Corredor:</span>
            <span class="detail-value">${equipment.corredor || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Prateleira:</span>
            <span class="detail-value">${equipment.prateleira || '-'}</span>
          </div>
          
          <div class="detail-section-title">Componentes</div>
          
          <div class="detail-group">
            <span class="detail-label">Neckrings:</span>
            <span class="detail-value">${equipment.neckrings || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Aneis Guias:</span>
            <span class="detail-value">${equipment.aneisGuias || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Thimbles:</span>
            <span class="detail-value">${equipment.thimble || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Machos:</span>
            <span class="detail-value">${equipment.machos || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Coolers:</span>
            <span class="detail-value">${equipment.coolers || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Baffles:</span>
            <span class="detail-value">${equipment.baffles || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Baffles Plugs:</span>
            <span class="detail-value">${equipment.bafflesPlugs || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Funis:</span>
            <span class="detail-value">${equipment.funis || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Fundos:</span>
            <span class="detail-value">${equipment.fundos || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Fundos Plugs:</span>
            <span class="detail-value">${equipment.fundosPlugs || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Sopradores:</span>
            <span class="detail-value">${equipment.sopradores || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Pinças:</span>
            <span class="detail-value">${equipment.pincas || '-'}</span>
          </div>
          
          <div class="detail-section-title">Informações Técnicas</div>
          
          <div class="detail-group">
            <span class="detail-label">Polimento Molde:</span>
            <span class="detail-value">${equipment.polimentoMolde || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Polimento Blank:</span>
            <span class="detail-value">${equipment.polimentoBlank || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Dimensional Gargalo (mm):</span>
            <span class="detail-value">Menos: ${equipment.diametroGargaloMenos || '-'} | Ideal: ${equipment.diametroGargaloIdeal || '-'} | Mais: ${equipment.diametroGargaloMais || '-'}</span>
          </div>
          
          <div class="detail-group">
            <span class="detail-label">Dimensional Corpo (mm):</span>
            <span class="detail-value">Menos: ${equipment.diametroCorpoMenos || '-'} | Ideal: ${equipment.diametroCorpoIdeal || '-'} | Mais: ${equipment.diametroCorpoMais || '-'}</span>
          </div>
          
          ${equipment.observacoesTopo ? `
          <div class="detail-group detail-full-width">
            <span class="detail-label">Observações:</span>
            <span class="detail-value">${equipment.observacoesTopo}</span>
          </div>
          ` : ''}
          
          ${equipment.observacaoAjustagem ? `
          <div class="detail-group detail-full-width">
            <span class="detail-label">Observações de Ajustagem:</span>
            <span class="detail-value">${equipment.observacaoAjustagem}</span>
          </div>
          ` : ''}
          
          ${equipment.causasTroca ? `
          <div class="detail-group detail-full-width">
            <span class="detail-label">Causas de Troca:</span>
            <span class="detail-value">${equipment.causasTroca}</span>
          </div>
          ` : ''}
          
          ${equipment.observacoesAdicionais ? `
          <div class="detail-group detail-full-width">
            <span class="detail-label">Observações Adicionais:</span>
            <span class="detail-value">${equipment.observacoesAdicionais}</span>
          </div>
          ` : ''}
        </div>
      `;
      
      openModal(equipmentDetailModal);
    }

    // ===================================================================
    // SISTEMA DE VÍDEOS
    // ===================================================================

    function renderVideos(list) {
      videoGrid.innerHTML = '';
      
      if (!list || list.length === 0) {
        videoGrid.innerHTML = '<div style="grid-column:1/-1;padding:20px;background:var(--card-bg);border-radius:12px;text-align:center">Nenhum vídeo encontrado.</div>';
        document.getElementById('totalVideos').textContent = '0';
        return;
      }
      
      document.getElementById('totalVideos').textContent = list.length;
      
      list.forEach(video => {
        const card = document.createElement('div');
        card.className = 'video-card';
        
        // Determina se é um vídeo incorporado (YouTube/Vimeo) ou arquivo MP4
        const isEmbed = video.url.includes('youtube.com/embed') || 
                       video.url.includes('player.vimeo.com') ||
                       video.url.includes('youtu.be');
        
        // Verifica se é um link do GitHub (raw.githubusercontent.com)
        const isGitHubRaw = video.url.includes('raw.githubusercontent.com');
        
        const videoHtml = isEmbed 
          ? `<div class="video-iframe"><iframe src="${video.url}" allowfullscreen></iframe></div>`
          : `<div class="video-iframe"><video controls><source src="${video.url}" type="video/mp4">Seu navegador não suporta vídeos.</video></div>`;
        
        card.innerHTML = `
          <h3>${escapeHtml(video.titulo)}</h3>
          ${videoHtml}
          <p>${escapeHtml(video.descricao || '')}</p>
          <div class="video-actions">
            <button class="edit-btn" data-id="${video.id}"><i class="fas fa-edit"></i> Editar</button>
            <button class="delete-btn" data-id="${video.id}"><i class="fas fa-trash"></i> Excluir</button>
          </div>
        `;
        
        videoGrid.appendChild(card);
      });
      
      // Configura os botões de ação nos vídeos
      document.querySelectorAll('.edit-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const id = btn.getAttribute('data-id');
          openEditVideoModal(id);
        });
      });
      
      document.querySelectorAll('.delete-btn').forEach(btn => {
        btn.addEventListener('click', async () => {
          const id = btn.getAttribute('data-id');
          
          // Solicita a senha de administrador
          const senha = prompt('Digite a senha de autorização para excluir vídeo:');
          if (String(senha || '').trim() !== String(ADMIN_PASSWORD || '').trim()) {
            alert('Senha incorreta. Exclusão cancelada.');
            return;
          }
          
          if (!confirm('Tem certeza que deseja excluir este vídeo?')) return;
          
          try {
            // Exclui o vídeo do Firestore
            await deleteVideoFromFirestore(id);
            showNotification('Vídeo excluído com sucesso!');
          } catch (err) {
            console.error(err);
            showNotification('Erro ao excluir vídeo. Verifique o console.', 'error');
          }
        });
      });
    }

    function openEditVideoModal(id) {
      const video = videoData.find(v => v.id === id);
      if (!video) return;
      
      // Solicita a senha de administrador
      const senha = prompt('Digite a senha de autorização para editar vídeo:');
      if (String(senha || '').trim() !== String(ADMIN_PASSWORD || '').trim()) {
        alert('Senha incorreta. Operação cancelada.');
        return;
      }
      
      // Preenche o formulário com os dados do vídeo
      document.getElementById('editVideoId').value = video.id;
      document.getElementById('editVideoTitulo').value = video.titulo;
      document.getElementById('editVideoDescricao').value = video.descricao || '';
      document.getElementById('editVideoUrl').value = video.url;
      document.getElementById('editVideoThumbnail').value = video.thumbnail || '';
      
      // Abre o modal de edição
      openModal(editVideoModal);
    }

    // ===================================================================
    // NAVEGAÇÃO POR ABAS
    // ===================================================================

    const tabEquip = document.getElementById('tabEquip');
    const tabVideos = document.getElementById('tabVideos');
    const tabContato = document.getElementById('tabContato');
    const tabContentEquip = document.getElementById('tabContentEquip');
    const tabContentVideos = document.getElementById('tabContentVideos');
    const tabContentContato = document.getElementById('tabContentContato');

    tabEquip.addEventListener('click', () => {
      tabEquip.classList.add('active');
      tabVideos.classList.remove('active');
      tabContato.classList.remove('active');
      tabContentEquip.classList.add('active');
      tabContentVideos.classList.remove('active');
      tabContentContato.classList.remove('active');
    });
    
    tabVideos.addEventListener('click', () => {
      tabVideos.classList.add('active');
      tabEquip.classList.remove('active');
      tabContato.classList.remove('active');
      tabContentVideos.classList.add('active');
      tabContentEquip.classList.remove('active');
      tabContentContato.classList.remove('active');
    });
    
    tabContato.addEventListener('click', () => {
      tabContato.classList.add('active');
      tabEquip.classList.remove('active');
      tabVideos.classList.remove('active');
      tabContentContato.classList.add('active');
      tabContentEquip.classList.remove('active');
      tabContentVideos.classList.remove('active');
    });

    // ===================================================================
    // INICIALIZAÇÃO DO FIREBASE
    // ===================================================================

    function initFirebase() {
      try {
        // Inicializa o Firebase
        firebase.initializeApp(firebaseConfig);
        db = firebase.firestore();
        useFirestore = true;
        
        // Configura o listener em tempo real para equipamentos
        const equipmentRef = db.collection('equipments_v1');
        
        unsubEquipmentSnapshot = equipmentRef.onSnapshot((snapshot) => {
          equipmentData = [];
          snapshot.forEach(doc => {
            equipmentData.push({ id: doc.id, ...doc.data() });
          });
          
          equipmentData.sort((a, b) => (b.criadoEm || '').localeCompare(a.criadoEm || ''));
          renderEquipment(getCurrentPageData());
          showNotification('Equipamentos carregados com sucesso!');
        }, (error) => {
          console.error('Erro no Firestore (equipamentos):', error);
          showNotification('Erro ao carregar equipamentos', 'error');
        });
        
        // Configura o listener em tempo real para vídeos
        const videosRef = db.collection('videos_v1');
        
        unsubVideoSnapshot = videosRef.onSnapshot((snapshot) => {
          videoData = [];
          snapshot.forEach(doc => {
            videoData.push({ id: doc.id, ...doc.data() });
          });
          
          videoData.sort((a, b) => (b.criadoEm || '').localeCompare(a.criadoEm || ''));
          renderVideos(videoData);
        }, (error) => {
          console.error('Erro no Firestore (vídeos):', error);
          showNotification('Erro ao carregar vídeos', 'error');
        });
        
      } catch (error) {
        console.error('Erro ao inicializar Firebase:', error);
        showNotification('Erro ao conectar com Firebase', 'error');
        useFirestore = false;
      }
    }

    // ===================================================================
    // FUNÇÕES DO FIRESTORE - EQUIPAMENTOS
    // ===================================================================

    async function addEquipmentToFirestore(equipment) {
      const equipmentRef = db.collection('equipments_v1');
      const docRef = await equipmentRef.add(equipment);
      return docRef.id;
    }

    async function updateEquipmentInFirestore(id, equipment) {
      const equipmentRef = db.collection('equipments_v1').doc(id);
      await equipmentRef.update(equipment);
    }

    async function deleteEquipmentFromFirestore(id) {
      const equipmentRef = db.collection('equipments_v1').doc(id);
      await equipmentRef.delete();
    }

    // ===================================================================
    // FUNÇÕES DO FIRESTORE - VÍDEOS
    // ===================================================================

    async function addVideoToFirestore(video) {
      const videoRef = db.collection('videos_v1');
      const docRef = await videoRef.add(video);
      return docRef.id;
    }

    async function updateVideoInFirestore(id, video) {
      const videoRef = db.collection('videos_v1').doc(id);
      await videoRef.update(video);
    }

    async function deleteVideoFromFirestore(id) {
      const videoRef = db.collection('videos_v1').doc(id);
      await videoRef.delete();
    }

    // ===================================================================
    // FORMULÁRIOS - EQUIPAMENTOS
    // ===================================================================

    // Configura o botão de adicionar equipamento
    addButton.addEventListener('click', () => {
      document.getElementById('addForm').reset();
      imagePreview.innerHTML = '';
      openModal(addModal);
    });

    // Preview de imagens ao digitar URLs
    document.getElementById('addUrlImg1').addEventListener('input', updateImagePreview);
    document.getElementById('addUrlImg2').addEventListener('input', updateImagePreview);
    
    // Preview de imagens para edição
    document.getElementById('editUrlImg1').addEventListener('input', updateEditImagePreview);
    document.getElementById('editUrlImg2').addEventListener('input', updateEditImagePreview);

    function updateImagePreview() {
      const url1 = document.getElementById('addUrlImg1').value;
      const url2 = document.getElementById('addUrlImg2').value;
      
      imagePreview.innerHTML = '';
      
      if (url1) {
        const img1 = document.createElement('img');
        img1.src = url1;
        img1.onerror = () => { img1.style.display = 'none'; };
        imagePreview.appendChild(img1);
      }
      
      if (url2) {
        const img2 = document.createElement('img');
        img2.src = url2;
        img2.onerror = () => { img2.style.display = 'none'; };
        imagePreview.appendChild(img2);
      }
    }
    
    function updateEditImagePreview() {
      const url1 = document.getElementById('editUrlImg1').value;
      const url2 = document.getElementById('editUrlImg2').value;
      
      editImagePreview.innerHTML = '';
      
      if (url1) {
        const img1 = document.createElement('img');
        img1.src = url1;
        img1.onerror = () => { img1.style.display = 'none'; };
        editImagePreview.appendChild(img1);
      }
      
      if (url2) {
        const img2 = document.createElement('img');
        img2.src = url2;
        img2.onerror = () => { img2.style.display = 'none'; };
        editImagePreview.appendChild(img2);
      }
    }

    // Configura o envio do formulário de adição de equipamento
    addForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      // Solicita a senha de administrador
      const senha = prompt('Digite a senha de autorização para salvar:');
      if (String(senha || '').trim() !== String(ADMIN_PASSWORD || '').trim()) {
        alert('Senha incorreta. Operação cancelada.');
        return;
      }
      
      // Coleta os dados do formulário (incluindo os novos campos dimensionais)
      const novo = {
        prefixoMolde: document.getElementById('addPrefixoMolde').value || '',
        moldeAlmox: document.getElementById('addMoldeAlmox').value || '',
        prefixoBlank: document.getElementById('addPrefixoBlank').value || '',
        blankAlmox: document.getElementById('addBlankAlmox').value || '',
        processo: document.getElementById('addProcesso').value || '',
        classe: document.getElementById('addClasse').value || '',
        neckrings: document.getElementById('addNeckrings').value || '',
        aneisGuias: document.getElementById('addAneisGuias').value || '',
        thimble: document.getElementById('addThimble').value || '',
        machos: document.getElementById('addMachos').value || '',
        coolers: document.getElementById('addCoolers').value || '',
        baffles: document.getElementById('addBaffles').value || '',
        bafflesPlugs: document.getElementById('addBafflesPlugs').value || '',
        funis: document.getElementById('addFunis').value || '',
        fundos: document.getElementById('addFundos').value || '',
        fundosPlugs: document.getElementById('addFundosPlugs').value || '',
        sopradores: document.getElementById('addSopradores').value || '',
        pincas: document.getElementById('addPincas').value || '',
        corredor: document.getElementById('addCorredor').value || '',
        prateleira: document.getElementById('addPrateleira').value || '',
        observacoesTopo: document.getElementById('addObservacoesTopo').value || '',
        polimentoMolde: document.getElementById('addPolimentoMolde').value || '',
        polimentoBlank: document.getElementById('addPolimentoBlank').value || '',
        observacaoAjustagem: document.getElementById('addObservacaoAjustagem').value || '',
        causasTroca: document.getElementById('addCausasTroca').value || '',
        // NOVOS CAMPOS DIMENSIONAIS
        diametroGargaloMenos: Number(document.getElementById('addDiametroGargaloMenos').value) || 0,
        diametroGargaloIdeal: Number(document.getElementById('addDiametroGargaloIdeal').value) || 0,
        diametroGargaloMais: Number(document.getElementById('addDiametroGargaloMais').value) || 0,
        diametroCorpoMenos: Number(document.getElementById('addDiametroCorpoMenos').value) || 0,
        diametroCorpoIdeal: Number(document.getElementById('addDiametroCorpoIdeal').value) || 0,
        diametroCorpoMais: Number(document.getElementById('addDiametroCorpoMais').value) || 0,
        observacoesAdicionais: document.getElementById('addObservacoesAdicionais').value || '',
        status: document.getElementById('addStatus').value || 'production',
        urlImg1: document.getElementById('addUrlImg1').value || '',
        urlImg2: document.getElementById('addUrlImg2').value || '',
        criadoEm: new Date().toISOString()
      };
      
      try {
        // Tenta salvar no Firestore se disponível
        if (useFirestore && db) {
          await addEquipmentToFirestore(novo);
        } else {
          // Caso contrário, salva no localStorage (fallback)
          novo.id = String(Date.now());
          equipmentData.push(novo);
          persistLocal();
          renderEquipment(getCurrentPageData());
        }
        closeModal(addModal);
        showNotification('Equipamento adicionado com sucesso!');
      } catch (err) {
        console.error(err);
        showNotification('Erro ao salvar. Veja console.', 'error');
      }
    });

    // ===================================================================
    // FUNÇÃO PARA ABRIR MODAL DE EDIÇÃO
    // ===================================================================

    function openEditModal(id) {
      const equipment = equipmentData.find(e => e.id === id);
      if (!equipment) return;
      
      // Solicita a senha de administrador
      const senha = prompt('Digite a senha de autorização para editar:');
      if (String(senha || '').trim() !== String(ADMIN_PASSWORD || '').trim()) {
        alert('Senha incorreta. Operação cancelada.');
        return;
      }
      
      // Preenche o formulário de edição com os dados do equipamento
      document.getElementById('editId').value = equipment.id;
      document.getElementById('editPrefixoMolde').value = equipment.prefixoMolde || '';
      document.getElementById('editMoldeAlmox').value = equipment.moldeAlmox || '';
      document.getElementById('editPrefixoBlank').value = equipment.prefixoBlank || '';
      document.getElementById('editBlankAlmox').value = equipment.blankAlmox || '';
      document.getElementById('editProcesso').value = equipment.processo || '';
      document.getElementById('editClasse').value = equipment.classe || '';
      document.getElementById('editNeckrings').value = equipment.neckrings || '';
      document.getElementById('editAneisGuias').value = equipment.aneisGuias || '';
      document.getElementById('editThimble').value = equipment.thimble || '';
      document.getElementById('editMachos').value = equipment.machos || '';
      document.getElementById('editCoolers').value = equipment.coolers || '';
      document.getElementById('editBaffles').value = equipment.baffles || '';
      document.getElementById('editBafflesPlugs').value = equipment.bafflesPlugs || '';
      document.getElementById('editFunis').value = equipment.funis || '';
      document.getElementById('editFundos').value = equipment.fundos || '';
      document.getElementById('editFundosPlugs').value = equipment.fundosPlugs || '';
      document.getElementById('editSopradores').value = equipment.sopradores || '';
      document.getElementById('editPincas').value = equipment.pincas || '';
      document.getElementById('editCorredor').value = equipment.corredor || '';
      document.getElementById('editPrateleira').value = equipment.prateleira || '';
      document.getElementById('editObservacoesTopo').value = equipment.observacoesTopo || '';
      document.getElementById('editPolimentoMolde').value = equipment.polimentoMolde || '';
      document.getElementById('editPolimentoBlank').value = equipment.polimentoBlank || '';
      document.getElementById('editObservacaoAjustagem').value = equipment.observacaoAjustagem || '';
      document.getElementById('editCausasTroca').value = equipment.causasTroca || '';
      // NOVOS CAMPOS DIMENSIONAIS
      document.getElementById('editDiametroGargaloMenos').value = equipment.diametroGargaloMenos || '';
      document.getElementById('editDiametroGargaloIdeal').value = equipment.diametroGargaloIdeal || '';
      document.getElementById('editDiametroGargaloMais').value = equipment.diametroGargaloMais || '';
      document.getElementById('editDiametroCorpoMenos').value = equipment.diametroCorpoMenos || '';
      document.getElementById('editDiametroCorpoIdeal').value = equipment.diametroCorpoIdeal || '';
      document.getElementById('editDiametroCorpoMais').value = equipment.diametroCorpoMais || '';
      document.getElementById('editObservacoesAdicionais').value = equipment.observacoesAdicionais || '';
      document.getElementById('editStatus').value = equipment.status || 'production';
      document.getElementById('editUrlImg1').value = equipment.urlImg1 || '';
      document.getElementById('editUrlImg2').value = equipment.urlImg2 || '';
      
      // Atualiza o preview das imagens
      updateEditImagePreview();
      
      openModal(editModal);
    }

    // Configura o envio do formulário de edição
    editForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const id = document.getElementById('editId').value;
      
      // Coleta os dados do formulário
      const editado = {
        prefixoMolde: document.getElementById('editPrefixoMolde').value || '',
        moldeAlmox: document.getElementById('editMoldeAlmox').value || '',
        prefixoBlank: document.getElementById('editPrefixoBlank').value || '',
        blankAlmox: document.getElementById('editBlankAlmox').value || '',
        processo: document.getElementById('editProcesso').value || '',
        classe: document.getElementById('editClasse').value || '',
        neckrings: document.getElementById('editNeckrings').value || '',
        aneisGuias: document.getElementById('editAneisGuias').value || '',
        thimble: document.getElementById('editThimble').value || '',
        machos: document.getElementById('editMachos').value || '',
        coolers: document.getElementById('editCoolers').value || '',
        baffles: document.getElementById('editBaffles').value || '',
        bafflesPlugs: document.getElementById('editBafflesPlugs').value || '',
        funis: document.getElementById('editFunis').value || '',
        fundos: document.getElementById('editFundos').value || '',
        fundosPlugs: document.getElementById('editFundosPlugs').value || '',
        sopradores: document.getElementById('editSopradores').value || '',
        pincas: document.getElementById('editPincas').value || '',
        corredor: document.getElementById('editCorredor').value || '',
        prateleira: document.getElementById('editPrateleira').value || '',
        observacoesTopo: document.getElementById('editObservacoesTopo').value || '',
        polimentoMolde: document.getElementById('editPolimentoMolde').value || '',
        polimentoBlank: document.getElementById('editPolimentoBlank').value || '',
        observacaoAjustagem: document.getElementById('editObservacaoAjustagem').value || '',
        causasTroca: document.getElementById('editCausasTroca').value || '',
        // NOVOS CAMPOS DIMENSIONAIS
        diametroGargaloMenos: Number(document.getElementById('editDiametroGargaloMenos').value) || 0,
        diametroGargaloIdeal: Number(document.getElementById('editDiametroGargaloIdeal').value) || 0,
        diametroGargaloMais: Number(document.getElementById('editDiametroGargaloMais').value) || 0,
        diametroCorpoMenos: Number(document.getElementById('editDiametroCorpoMenos').value) || 0,
        diametroCorpoIdeal: Number(document.getElementById('editDiametroCorpoIdeal').value) || 0,
        diametroCorpoMais: Number(document.getElementById('editDiametroCorpoMais').value) || 0,
        observacoesAdicionais: document.getElementById('editObservacoesAdicionais').value || '',
        status: document.getElementById('editStatus').value || 'production',
        urlImg1: document.getElementById('editUrlImg1').value || '',
        urlImg2: document.getElementById('editUrlImg2').value || '',
        atualizadoEm: new Date().toISOString()
      };
      
      try {
        // Tenta atualizar no Firestore se disponível
        if (useFirestore && db) {
          await updateEquipmentInFirestore(id, editado);
        } else {
          // Caso contrário, atualiza no localStorage (fallback)
          const index = equipmentData.findIndex(e => e.id === id);
          if (index !== -1) {
            equipmentData[index] = { ...equipmentData[index], ...editado };
            persistLocal();
            renderEquipment(getCurrentPageData());
          }
        }
        closeModal(editModal);
        showNotification('Equipamento atualizado com sucesso!');
      } catch (err) {
        console.error(err);
        showNotification('Erro ao atualizar. Veja console.', 'error');
      }
    });

    // ===================================================================
    // FORMULÁRIOS - VÍDEOS
    // ===================================================================

    // Configura o envio do formulário de adição de vídeo
    addVideoBtn.addEventListener('click', async () => {
      // Solicita a senha de administrador
      const senha = prompt('Digite a senha de autorização para adicionar vídeo:');
      if (String(senha || '').trim() !== String(ADMIN_PASSWORD || '').trim()) {
        alert('Senha incorreta. Operação cancelada.');
        return;
      }
      
      const titulo = document.getElementById('videoTitulo').value;
      const descricao = document.getElementById('videoDescricao').value;
      const url = document.getElementById('videoUrl').value;
      const thumbnail = document.getElementById('videoThumbnail').value;
      
      if (!titulo || !url) {
        alert('Título e URL são obrigatórios!');
        return;
      }
      
      const novoVideo = {
        titulo,
        descricao,
        url,
        thumbnail,
        criadoEm: new Date().toISOString()
      };
      
      try {
        // Tenta salvar no Firestore se disponível
        if (useFirestore && db) {
          await addVideoToFirestore(novoVideo);
        } else {
          // Caso contrário, salva no localStorage (fallback)
          novoVideo.id = String(Date.now());
          videoData.push(novoVideo);
          persistLocal();
          renderVideos(videoData);
        }
        
        // Limpa o formulário
        document.getElementById('videoTitulo').value = '';
        document.getElementById('videoDescricao').value = '';
        document.getElementById('videoUrl').value = '';
        document.getElementById('videoThumbnail').value = '';
        
        showNotification('Vídeo adicionado com sucesso!');
      } catch (err) {
        console.error(err);
        showNotification('Erro ao salvar vídeo. Verifique o console.', 'error');
      }
    });

    // Configura o envio do formulário de edição de vídeo
    editVideoForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const id = document.getElementById('editVideoId').value;
      const titulo = document.getElementById('editVideoTitulo').value;
      const descricao = document.getElementById('editVideoDescricao').value;
      const url = document.getElementById('editVideoUrl').value;
      const thumbnail = document.getElementById('editVideoThumbnail').value;
      
      if (!titulo || !url) {
        alert('Título e URL são obrigatórios!');
        return;
      }
      
      const videoEditado = {
        titulo,
        descricao,
        url,
        thumbnail,
        atualizadoEm: new Date().toISOString()
      };
      
      try {
        // Tenta atualizar no Firestore se disponível
        if (useFirestore && db) {
          await updateVideoInFirestore(id, videoEditado);
        } else {
          // Caso contrário, atualiza no localStorage (fallback)
          const index = videoData.findIndex(v => v.id === id);
          if (index !== -1) {
            videoData[index] = { ...videoData[index], ...videoEditado };
            persistLocal();
            renderVideos(videoData);
          }
        }
        
        closeModal(editVideoModal);
        showNotification('Vídeo atualizado com sucesso!');
      } catch (err) {
        console.error(err);
        showNotification('Erro ao atualizar vídeo. Verifique o console.', 'error');
      }
    });

    // ===================================================================
    // SISTEMA DE BUSCA
    // ===================================================================

    // Configura a busca tradicional
    searchButton.addEventListener('click', () => {
      const termo = searchInput.value.trim().toLowerCase();
      if (!termo) {
        renderEquipment(getCurrentPageData());
        return;
      }
      
      const resultado = equipmentData.filter(e => {
        const prefixoMolde = (e.prefixoMolde || '').toLowerCase();
        const prefixoBlank = (e.prefixoBlank || '').toLowerCase();
        
        return prefixoMolde.includes(termo) || prefixoBlank.includes(termo);
      });
      
      // Atualiza o filtro atual para 'all' para não conflitar com a busca
      currentFilter = 'all';
      filters.forEach(f => f.classList.remove('active'));
      document.querySelector('[data-filter="all"]').classList.add('active');
      
      // Ordena o resultado
      const resultadoOrdenado = sortEquipment(resultado);
      
      // Mostra apenas a primeira página dos resultados
      currentPage = 1;
      const paginaResultados = resultadoOrdenado.slice(0, itemsPerPage);
      
      renderEquipment(paginaResultados);
      
      // Atualiza os controles de paginação para os resultados
      updatePaginationControls();
    });

    // Busca por voz através do campo de busca inteligente
    aiSearchButton.addEventListener('click', () => {
      const termo = aiSearchInput.value.trim().toUpperCase();
      if (!termo) return;
      
      const equipment = findEquipmentByPrefix(termo);
      
      if (equipment) {
        // Remove qualquer highlight anterior
        if (currentHighlightedEquipment) {
          const previousCard = document.querySelector(`[data-id="${currentHighlightedEquipment}"]`);
          if (previousCard) {
            previousCard.closest('.equipment-card').classList.remove('highlighted');
          }
          currentHighlightedEquipment = null;
        }
        
        // Destaca o equipamento na lista
        currentHighlightedEquipment = equipment.id;
        renderEquipment(getCurrentPageData());
        
        // Mostra informações detalhadas
        showEquipmentDetails(equipment);
        showNotification(`Mostrando informações do equipamento ${termo}`);
      } else {
        showNotification(`Equipamento com prefixo ${termo} não encontrado.`, 'error');
      }
    });

    // Configura a busca de vídeos
    videoSearch.addEventListener('input', () => {
      const termo = videoSearch.value.trim().toLowerCase();
      
      if (!termo) {
        renderVideos(videoData);
        return;
      }
      
      const resultado = videoData.filter(v => {
        const titulo = (v.titulo || '').toLowerCase();
        const descricao = (v.descricao || '').toLowerCase();
        
        return titulo.includes(termo) || descricao.includes(termo);
      });
      
      renderVideos(resultado);
    });

    // ===================================================================
    // SISTEMA DE FILTROS
    // ===================================================================

    filters.forEach(btn => {
      btn.addEventListener('click', (e) => {
        filters.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentFilter = btn.getAttribute('data-filter');
        currentPage = 1; // Volta para a primeira página ao mudar o filtro
        renderEquipment(getCurrentPageData());
      });
    });

    // ===================================================================
    // SISTEMA DE DEFEITOS
    // ===================================================================

    defectsButton.addEventListener('click', () => {
      openModal(defectsModal);
    });

    const defectInfoMap = {
      'H-': 'O que é: Altura do gargalo menor que o especificado.\nO que causa: Excesso de pressão durante a moldagem.\nSolução: Reduzir pressão e verificar temperatura do molde.',
      'H+': 'O que é: Altura do gargalo maior que o especificado.\nO que causa: Pressão insuficiente durante a moldagem.\nSolução: Aumentar pressão e verificar vazamentos.',
      'C-': 'O que é: Diâmetro do corpo menor que o especificado.\nO que causa: Temperatura do molde muito baixa.\nSolução: Aumentar temperatura do molde.',
      'C+': 'O que é: Diâmetro do corpo maior que o especificado.\nO que causa: Temperatura do molde muito alta.\nSolução: Reduzir temperatura do molde.',
      'Ombro Negativo': 'O que é: Formação irregular no ombro da garrafa.\nO que causa: Problemas na distribuição do material.\nSolução: Ajustar parâmetros de sopro e temperatura.',
      'Friso': 'O que é: Linha visível na junção do molde.\nO que causa: Desgaste ou má vedação do molde.\nSolução: Verificar e substituir componentes do molde.',
      'Rebarba na terminação': 'O que é: Excesso de material nas bordas.\nO que causa: Folga excessiva no molde.\nSolução: Ajustar folgas e verificar pressão de fechamento.',
      'Marca de Molde': 'O que é: Marcas superficiais na garrafa.\nO que causa: Superfície do molde danificada ou suja.\nSolução: Limpar e polir o molde.',
      'Equipamento fora de Centro': 'O que é: Garrafa assimétrica.\nO que causa: Alinhamento incorreto do molde.\nSolução: Verificar e ajustar o alinhamento do molde.',
      'Pressão': 'O que é: Problemas relacionados à pressão de sopro.\nO que causa: Vazamentos ou falha no sistema de pressão.\nSolução: Verificar vazamentos e calibrar sistema.',
      'Costura': 'O que é: Linha visível na junção das partes do molde.\nO que causa: Desalinhamento ou desgaste do molde.\nSolução: Verificar alinhamento e substituir peças desgastadas.'
    };

    defectSelect.addEventListener('change', () => {
      const valor = defectSelect.value;
      
      if (valor && defectInfoMap[valor]) {
        defectInfo.style.display = 'block';
        defectText.value = defectInfoMap[valor];
      } else {
        defectInfo.style.display = 'none';
        defectText.value = '';
      }
    });

    // ===================================================================
    // FUNÇÕES AUXILIARES
    // ===================================================================

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function persistLocal() {
      localStorage.setItem('equipmentData', JSON.stringify(equipmentData));
      localStorage.setItem('videoData', JSON.stringify(videoData));
    }

    function loadLocal() {
      const storedEquipment = localStorage.getItem('equipmentData');
      const storedVideos = localStorage.getItem('videoData');
      
      if (storedEquipment) {
        equipmentData = JSON.parse(storedEquipment);
        renderEquipment(getCurrentPageData());
      }
      
      if (storedVideos) {
        videoData = JSON.parse(storedVideos);
        renderVideos(videoData);
      }
    }

    // ===================================================================
    // INICIALIZAÇÃO DO SISTEMA
    // ===================================================================

    function init() {
      // Inicializa o tema
      initTheme();
      
      // Tenta inicializar o Firebase
      initFirebase();
      
      // Se não conseguiu conectar ao Firebase, carrega dados locais
      if (!useFirestore) {
        loadLocal();
      }
      
      // Aplica o idioma padrão
      applyLanguage(currentLang);
      
      // Configura o fechamento do modal de imagem
      document.getElementById('imageModal').addEventListener('click', (e) => {
        if (e.target === document.getElementById('imageModal')) {
          document.getElementById('imageModal').classList.remove('show');
        }
      });
      
      showNotification('Sistema carregado com sucesso!');
    }

    // Inicializa o sistema quando a página carrega
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
